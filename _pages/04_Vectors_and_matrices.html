
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 4: Vectors and Matrices &#8212; Computer Graphics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"vec": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_pages/04_Vectors_and_matrices';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 5: Transformations" href="05_Transformations.html" />
    <link rel="prev" title="Lab 3: Textures" href="03_Textures.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Computer Graphics - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Computer Graphics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Contents
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preliminaries</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="P_Core_concepts.html">Core Computer Graphics Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="P_Software.html">Visual Studio Code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_intro_to_javascript.html">Lab 1: Introduction to JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Basic_shapes.html">Lab 2: Drawing Basic Shapes in WebGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_Textures.html">Lab 3: Textures</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 4: Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_Transformations.html">Lab 5: Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_3D_worlds.html">Lab 6: 3D Worlds</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_Moving_the_camera.html">Lab 7: Moving the Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_Lighting.html">Lab 8: Lighting</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_Normal_mapping.html">Lab 9: Normal Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Quaternions.html">Lab 10: Quaternions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A1_Complex_numbers_and_quaternions.html">Appendix A: Complex Numbers and Quaternions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jonshiach/graphics-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jonshiach/graphics-notes/issues/new?title=Issue%20on%20page%20%2F_pages/04_Vectors_and_matrices.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_pages/04_Vectors_and_matrices.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 4: Vectors and Matrices</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-addition-and-subtraction">Vector addition and subtraction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplication-by-a-scalar">Multiplication by a scalar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-magnitude">Vector magnitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-vectors">Unit vectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dot-product">The dot product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-cross-product">The cross product</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices">Matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-transpose">Matrix transpose</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-multiplication">Matrix multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-major-order">Column-major order</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-identity-matrix">The Identity Matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-inverse">Matrix Inverse</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-walkthrough">Video Walkthrough</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-4-vectors-and-matrices">
<span id="vectors-and-matrices-section"></span><h1>Lab 4: Vectors and Matrices<a class="headerlink" href="#lab-4-vectors-and-matrices" title="Link to this heading">#</a></h1>
<p>Computer graphics relies heavily on mathematics of vectors and matrices. In this lab we will be revising the important concepts needed for computer graphics and using a library to perform calculations.</p>
<p>In this lab we will not be drawing any graphical objects, but we will be writing JavaScript code to perform calculations. So the first thing we are going to do is set up a simple HTML page and write a JavaScript function to print console output to the page.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Create a folder called <em><strong>Lab 4 Vectors and Matrices</strong></em> inside which create a file called <em><strong>index.html</strong></em> and enter the following into it.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>

<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Lab 4 - Vectors and Matrices<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;console-output&quot;</span> 
         <span class="na">style</span><span class="o">=</span><span class="s">&quot;font-family:monospace; white-space: pre; padding:10px;&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;maths.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;vectors_and_matrices.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Create another file called <em><strong>vectors_and_matrices.js</strong></em> and enter the following into it.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">setupConsoleOutput</span><span class="p">(</span><span class="nx">elementId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">elementId</span><span class="p">);</span>

<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">write</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">line</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">args</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">output</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">write</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">setupConsoleOutput</span><span class="p">(</span><span class="s2">&quot;console-output&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Lab 5 - Vectors and Matrices\n----------------------------&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>Here we have the function <code class="docutils literal notranslate"><span class="pre">setupConsoleOutput()</span></code> in the <em><strong>vectors_and_matrices.js</strong></em> file which means that any call to <code class="docutils literal notranslate"><span class="pre">console.log()</span></code> will output to the HTML page.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Lab 5 - Vectors and Matrices
----------------------------
</pre></div>
</div>
<hr class="docutils" />
<section id="vectors">
<h2>Vectors<a class="headerlink" href="#vectors" title="Link to this heading">#</a></h2>
<p>A vector in is an object with magnitude (length) and direction. A vector is denoted by a lower case letter in boldface, e.g., <span class="math notranslate nohighlight">\(\vec{a}\)</span> (or underlined when writing by hand), and represented mathematically by a tuple which is an ordered set of numbers. In geometry, each number in the vector represents the length along the co-ordinate axes. For example, consider the 3-element vector</p>
<div class="math notranslate nohighlight">
\[\vec{a} = (a_x, a_y, a_z).\]</div>
<p>Here <span class="math notranslate nohighlight">\(\vec{a}\)</span> has 3 elements so is a vector in 3D space where <span class="math notranslate nohighlight">\(a_x\)</span>, <span class="math notranslate nohighlight">\(a_y\)</span> and <span class="math notranslate nohighlight">\(a_z\)</span> are the lengths of the vector in the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> directions.</p>
<figure class="align-default" id="d-vector">
<a class="reference internal image-reference" href="../_images/04_vector.svg"><img alt="../_images/04_vector.svg" src="../_images/04_vector.svg" style="height: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">A 3D vector.</span><a class="headerlink" href="#d-vector" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The reason the diagram above has the <span class="math notranslate nohighlight">\(y\)</span>-axis pointing upwards and the <span class="math notranslate nohighlight">\(z\)</span>-axis pointing along the horizontal is because this is the way WebGL represents 3D space (see <a class="reference internal" href="05_Transformations.html#transformations-section"><span class="std std-ref">Lab 5: Transformations</span></a> for more details). The configuration of the axes does not matter for the calculations we will be performing in this lab, but I wanted to be consistent.</p>
</div>
<p>Since we will be using vectors (and matrices) a lot over the rest of the labs we will create a file containing helper functions to perform operations.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Create file called <em><strong>maths.js</strong></em> and enter the following function definition.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Vector operations</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="sb">`[ </span><span class="si">${</span><span class="nx">v</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">v</span><span class="p">[</span><span class="mf">1</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">v</span><span class="p">[</span><span class="mf">2</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb"> ]`</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here we have defined a function that prints a 3-element vector. Now let’s create the following vectors in JavaScript and print them.</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
    \vec{a} &amp;= (3, 0, 4), &amp;
    \vec{b} &amp;= (1, 2, 3).
\end{align*}\]</div>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following code to the <em><strong>vectors_and_matrices.js</strong></em> file.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Vectors</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nVectors\n-------&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">];</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">];</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;a = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;b = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">b</span><span class="p">));</span>
</pre></div>
</div>
</div>
<p>Here we have created the two vectors <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> and printed these to our webpage which should now look like</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Vectors
-------
a = [ 3.00, 0.00, 4.00 ]
b = [ 1.00, 2.00, 3.00 ]
</pre></div>
</div>
<section id="vector-addition-and-subtraction">
<h3>Vector addition and subtraction<a class="headerlink" href="#vector-addition-and-subtraction" title="Link to this heading">#</a></h3>
<p>Like numbers, we can define the arithmetic operations of addition, subtraction for vectors as well as multiplication and division by a scalar. The addition and subtraction of two vectors <span class="math notranslate nohighlight">\(\vec{a} = (a_x, a_y, a_z)\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = (b_x, b_y, b_z)\)</span> is defined by</p>
<div class="math notranslate nohighlight" id="equation-eq-vector-addition">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-vector-addition" title="Link to this equation">#</a></span>\[\begin{split} \begin{align*}
    \vec{a} + \vec{b} &amp;= (a_x + b_x, a_y + b_y, a_z + b_z), \\
    \vec{a} - \vec{b} &amp;= (a_x - b_x, a_y - b_y, a_z - b_z).
\end{align*} \end{split}\]</div>
<p>For example, given the vectors <span class="math notranslate nohighlight">\(\vec{a} = (3,0,4)\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = (1, 2, 3)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \vec{a} + \vec{b} &amp;= (3, 0, 4) + (1, 2, 3) = (3 + 1, 0 + 2, 4 + 3) = (4, 2, 7), \\
    \vec{a} - \vec{b} &amp;= (3, 0, 4) - (1, 2, 3) = (3 - 1, 0 - 2, 4 - 3) = (2, -2, 1).
\end{align*}\end{split}\]</div>
<p>What is happening in a geometrical sense when we add and subtract vectors? Take a look at <a class="reference internal" href="#vector-addition-figure"><span class="std std-numref">Fig. 22</span></a>, here the vector <span class="math notranslate nohighlight">\(\vec{b}\)</span> has been added to the vector <span class="math notranslate nohighlight">\(\vec{a}\)</span> where the tail of <span class="math notranslate nohighlight">\(\vec{b}\)</span> is placed at the head of <span class="math notranslate nohighlight">\(\vec{a}\)</span>. The resulting vector <span class="math notranslate nohighlight">\(\vec{a} + \vec{b}\)</span> points from the tail of <span class="math notranslate nohighlight">\(\vec{a}\)</span> to the head of <span class="math notranslate nohighlight">\(\vec{b}\)</span>.</p>
<figure class="align-default" id="vector-addition-figure">
<a class="reference internal image-reference" href="../_images/04_vector_addition.svg"><img alt="../_images/04_vector_addition.svg" src="../_images/04_vector_addition.svg" style="height: 150px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Vector addition.</span><a class="headerlink" href="#vector-addition-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The subtraction of the vector <span class="math notranslate nohighlight">\(\vec{b}\)</span> does similar, but since <span class="math notranslate nohighlight">\(\vec{a} - \vec{b} = \vec{a} + (-1)\vec{b}\)</span> then the direction of <span class="math notranslate nohighlight">\(\vec{b}\)</span> is reversed so <span class="math notranslate nohighlight">\(\vec{a} - \vec{b}\)</span> is the same as placing the tail of <span class="math notranslate nohighlight">\(-\vec{b}\)</span> at the head of <span class="math notranslate nohighlight">\(\vec{a}\)</span>.</p>
<figure class="align-default" id="vector-subtraction-figure">
<a class="reference internal image-reference" href="../_images/04_vector_subtraction.svg"><img alt="../_images/04_vector_subtraction.svg" src="../_images/04_vector_subtraction.svg" style="height: 180px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">Vector subtraction.</span><a class="headerlink" href="#vector-subtraction-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>To calculate the addition and subtraction of vectors we are going to write functions to do this.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following functions to the <em><strong>maths.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">addVector</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">subtractVector</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here we have defined two similar functions <code class="docutils literal notranslate"><span class="pre">addVector()</span></code> and <code class="docutils literal notranslate"><span class="pre">subtractVector()</span></code> that add and subtract two vectors.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following to the <em><strong>Vectors_and_matrices.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Arithmetic operations on vectors</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;\nArithmetic operations on vectors\n--------------------------------&#39;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;a + b =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">addVector</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;a - b =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">subtractVector</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Arithmetic operations on vectors
--------------------------------
a + b = [ 4.00, 2.00, 7.00 ]
a - b = [ 2.00, -2.00, 1.00 ]
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="multiplication-by-a-scalar">
<h3>Multiplication by a scalar<a class="headerlink" href="#multiplication-by-a-scalar" title="Link to this heading">#</a></h3>
<p>Multiplication of a vector <span class="math notranslate nohighlight">\(\vec{a} = (a_x, a_y, a_z)\)</span> by a scalar (a number) <span class="math notranslate nohighlight">\(k\)</span> are defined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    k \vec{a} &amp;= (ka_x, ka_y, ka_z), \\
    \frac{\vec{a}}{k} &amp;= \left(\frac{a_x}{k}, \frac{a_y}{k}, \frac{a_z}{k} \right).
\end{align*}\end{split}\]</div>
<p>For example, multiplying the vector <span class="math notranslate nohighlight">\(\vec{a} = (3, 0, 4)\)</span> by the scalar 2 gives</p>
<div class="math notranslate nohighlight">
\[2\vec{a} = 2(3,0,4) = (6, 0, 8).\]</div>
<p>If we wanted to divide by a scale <span class="math notranslate nohighlight">\(k\)</span> then we simply multiply by <span class="math notranslate nohighlight">\(\dfrac{1}{k}\)</span>. For example, dividing the vector <span class="math notranslate nohighlight">\(\vec{b} = (1, 2, 3)\)</span> by 3 gives</p>
<div class="math notranslate nohighlight">
\[\frac{\vec{b}}{3} = \frac{1}{3} \vec{b} = \left( \frac{1}{3}, \frac{2}{3}, \frac{3}{3} \right) = (0.3333, 0.6667, 1).\]</div>
<p>Multiplying a vector by a positive scalar has the effect of scaling the length of the vector. Multiplying by a negative scalar reverses the direction of the vector.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/04_vector_scalar_multiplication.svg"><img alt="../_images/04_vector_scalar_multiplication.svg" src="../_images/04_vector_scalar_multiplication.svg" style="height: 180px;" />
</a>
</figure>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following function to the <em><strong>maths.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">scaleVector</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nx">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="nx">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="w"> </span><span class="nx">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add the following to the <em><strong>vectors_and_matrices.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;2a    =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">scaleVector</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;b/3   =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">scaleVector</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="o">/</span><span class="mf">3</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>2a    = [ 6.00, 0.00, 8.00 ]
b/3   = [ 0.33, 0.67, 1.00 ]
</pre></div>
</div>
<hr class="docutils" />
</section>
<section id="vector-magnitude">
<span id="vector-magnitude-section"></span><h3>Vector magnitude<a class="headerlink" href="#vector-magnitude" title="Link to this heading">#</a></h3>
<p>The length or <strong>magnitude</strong> of a vector <span class="math notranslate nohighlight">\(\vec{a} = (a_x, a_y, a_z)\)</span> is denoted by <span class="math notranslate nohighlight">\(\|\vec{a}\|\)</span> is the length from the tail of the vector to the head.</p>
<figure class="align-default" id="magnitude-figure">
<a class="reference internal image-reference" href="../_images/04_vector_magnitude.svg"><img alt="../_images/04_vector_magnitude.svg" src="../_images/04_vector_magnitude.svg" style="height: 100px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">Vector magnitude (length).</span><a class="headerlink" href="#magnitude-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The magnitude is calculated using an extension of Pythagoras’ theorem, for example for 3D vectors the magnitude is</p>
<div class="math notranslate nohighlight" id="equation-eq-vector-magnitude">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-vector-magnitude" title="Link to this equation">#</a></span>\[\|\vec{a}\| = \sqrt{a_x^2 + a_y^2 + a_z^2}. \]</div>
<p>For example, if <span class="math notranslate nohighlight">\(\vec{a} = (3, 0, 4)\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = (1, 2, 3)\)</span> then their magnitudes are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \| \vec{a} \| &amp;= \sqrt{3^2 + 0^2 + 4^2} = \sqrt{9 + 0 + 16} = \sqrt{25} = 5, \\
    \| \vec{b} \| &amp;= \sqrt{1^2 + 2^2 + 3^2} = \sqrt{1 + 4 + 9} = \sqrt{14} = 3.74\ldots
\end{align*}\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following function to the <em><strong>maths.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">length</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">v</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">v</span><span class="p">[</span><span class="mf">2</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Vector magnitude and normalization</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nVector magnitude and normalization\n----------------------------------&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;length(a)    = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">length</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;length(b)    = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">length</span><span class="p">(</span><span class="nx">b</span><span class="p">));</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Vector magnitude and normalization
----------------------------------
length(a)    = 5
length(b)    = 3.7416573867739413
</pre></div>
</div>
<hr class="docutils" />
</section>
<section id="unit-vectors">
<span id="unit-vectors-section"></span><h3>Unit vectors<a class="headerlink" href="#unit-vectors" title="Link to this heading">#</a></h3>
<p>A <strong>unit vector</strong> is a vector that has a length of 1. We can find a unit vector that points in the same direction as a non-zero vector <span class="math notranslate nohighlight">\(\vec{a}\)</span>, which is denoted by <span class="math notranslate nohighlight">\(\hat{\vec{a}}\)</span> (pronounced <em>a-hat</em>), by dividing by its magnitude, i.e.,</p>
<div class="math notranslate nohighlight" id="equation-eq-unit-vector">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-unit-vector" title="Link to this equation">#</a></span>\[ \hat{\vec{a}} = \frac{\vec{a}}{\|\vec{a}\|}. \]</div>
<p>This process is called <strong>normalising a vector</strong>. For example, to determine a unit vector pointing in the same direction as the vector <span class="math notranslate nohighlight">\(\vec{a} = (3, 0, 4)\)</span>, we normalise it by dividing by its magnitude which is 5.</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
    \hat{\vec{a}} &amp;= \frac{(3, 0, 4)}{5} = \left( \frac{3}{5}, 0, \frac{4}{5} \right) = (0.6, 0, 0.8).
\end{align*}\]</div>
<p>Checking that <span class="math notranslate nohighlight">\(\hat{\vec{a}}\)</span> has a magnitude of 1</p>
<div class="math notranslate nohighlight">
\[\|\hat{\vec{a}}\| = \sqrt{0.6^2 + 0^2 + 0.8^2} = \sqrt{0.36 + 0.64} = \sqrt{1} = 1.\]</div>
<p>Normalizing a vector is an operation that is used a lot in graphics programming, so it would be useful to have a function that does this.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following function to the <em><strong>maths.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">length</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">len</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">];</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">scaleVector</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">len</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">aHat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">bHat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;aHat         = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">aHat</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;bHat         = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">bHat</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;length(aHat) = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">length</span><span class="p">(</span><span class="nx">aHat</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;length(bHat) = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">length</span><span class="p">(</span><span class="nx">bHat</span><span class="p">));</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>aHat         = [ 0.60, 0.00, 0.80 ]
bHat         = [ 0.27, 0.53, 0.80 ]
length(aHat) = 1
length(bHat) = 1
</pre></div>
</div>
<p>Both <code class="docutils literal notranslate"><span class="pre">aHat</span></code> and <code class="docutils literal notranslate"><span class="pre">bHat</span></code> have magnitudes of 1 which shows they are both unit vectors.</p>
<hr class="docutils" />
</section>
<section id="the-dot-product">
<span id="dot-product-section"></span><h3>The dot product<a class="headerlink" href="#the-dot-product" title="Link to this heading">#</a></h3>
<p>The <a href="https://en.wikipedia.org/wiki/Dot_product" target="_blank"><strong>dot product</strong></a> between two vectors <span class="math notranslate nohighlight">\(\vec{a} = (a_x, a_y, a_z)\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = (b_x, b_y, b_z)\)</span> is denoted by <span class="math notranslate nohighlight">\(\vec{a} \cdot \vec{b}\)</span> and returns a scalar. The dot product is calculated using</p>
<div class="math notranslate nohighlight" id="equation-eq-dot-product">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-dot-product" title="Link to this equation">#</a></span>\[ \vec{a} \cdot \vec{b} = a_xb_x + a_yb_y + a_zb_z. \]</div>
<p>The dot product is related to the angle <span class="math notranslate nohighlight">\(\theta\)</span> between the two vectors (<a class="reference internal" href="#angle-between-vectors-figure"><span class="std std-numref">Fig. 25</span></a>) by</p>
<div class="math notranslate nohighlight" id="equation-eq-dot-product-geometric">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-dot-product-geometric" title="Link to this equation">#</a></span>\[ \vec{a} \cdot \vec{b} = \|\vec{a}\| \|\vec{b}\| \cos(\theta). \]</div>
<figure class="align-default" id="angle-between-vectors-figure">
<a class="reference internal image-reference" href="../_images/04_dot_product.svg"><img alt="../_images/04_dot_product.svg" src="../_images/04_dot_product.svg" style="height: 125px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">The angle <span class="math notranslate nohighlight">\(\theta\)</span> between the vectors <span class="math notranslate nohighlight">\(\vec{a}\)</span> and <span class="math notranslate nohighlight">\(\vec{b}\)</span>.</span><a class="headerlink" href="#angle-between-vectors-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>A useful result for computer graphics is that if <span class="math notranslate nohighlight">\(\theta=90^\circ\)</span> then <span class="math notranslate nohighlight">\(\cos(\theta) = 0\)</span> and equation <a class="reference internal" href="#equation-eq-dot-product-geometric">(5)</a> becomes</p>
<div class="math notranslate nohighlight">
\[\vec{a} \cdot \vec{b} = 0.\]</div>
<p>In order words, if the dot product of two vectors is zero then the two vectors are perpendicular. For example, given the vectors <span class="math notranslate nohighlight">\(\vec{a} = (3, 0, 4)\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = (1, 2, 3)\)</span> the dot product between these are</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
    \vec{a} \cdot \vec{b} &amp;= (3, 0, 4) \cdot (1, 2, 3)
    = 3 + 0 + 12
    = 15.
\end{align*}\]</div>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following function to the <em><strong>maths.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">dot</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">2</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Dot and cross products</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nDot and cross products\n----------------------&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;a . b = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="nx">dot</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">));</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Dot and cross products
----------------------
a . b = 15
</pre></div>
</div>
<hr class="docutils" />
</section>
<section id="the-cross-product">
<span id="cross-product-section"></span><h3>The cross product<a class="headerlink" href="#the-cross-product" title="Link to this heading">#</a></h3>
<p>The <a href="https://en.wikipedia.org/wiki/Cross_product" target="_blank"><strong>cross product</strong></a> between two 3-element vectors <span class="math notranslate nohighlight">\(\vec{a} = (a_x, a_y, a_z)\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = (b_x, b_y, b_z)\)</span> is denoted by <span class="math notranslate nohighlight">\(\vec{a} \times \vec{b}\)</span> and returns a vector. The cross product is calculated using</p>
<div class="math notranslate nohighlight" id="equation-eq-cross-product">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-cross-product" title="Link to this equation">#</a></span>\[ \vec{a} \times \vec{b} = (a_yb_z - a_zb_y, a_zb_x - a_xb_z, a_xb_y - a_yb_x). \]</div>
<p>The cross product between two vectors produces another vector that is perpendicular to both of the vectors (<a class="reference internal" href="#cross-product-figure"><span class="std std-numref">Fig. 26</span></a>). This is another incredibly useful result as it allows us to calculate a <a class="reference internal" href="07_Moving_the_camera.html#normal-vector-section"><span class="std std-ref"><strong>normal vector</strong></span></a> to a polygon which are used in calculating how light is reflected off surfaces (see <a class="reference internal" href="08_Lighting.html#lighting-section"><span class="std std-ref">Lab 8: Lighting</span></a>).</p>
<figure class="align-default" id="cross-product-figure">
<a class="reference internal image-reference" href="../_images/04_cross_product.svg"><img alt="../_images/04_cross_product.svg" src="../_images/04_cross_product.svg" style="height: 220px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">The cross product between two vectors gives a vector that is perpendicular to both vectors.</span><a class="headerlink" href="#cross-product-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>For example, given the vectors <span class="math notranslate nohighlight">\(\vec{a} = (3,0,4)\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = (1, 2, 3)\)</span> the cross product <span class="math notranslate nohighlight">\(\vec{a} \times \vec{b}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \vec{a} \times \vec{b} &amp;= (3, 0, 4) \times (1, 2, 3) \\
    &amp;= (0 \times 3 - 4 \times 2, 4 \times 1 - 3 \times 3, 3 \times 2 - 0 \times 3) \\
    &amp;= (-8, -5, 6).
\end{align*}\end{split}\]</div>
<p>We can show that <span class="math notranslate nohighlight">\(\vec{a} \times \vec{b}\)</span> is perpendicular to both <span class="math notranslate nohighlight">\(\vec{a}\)</span> and <span class="math notranslate nohighlight">\(\vec{b}\)</span> using the dot product</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \vec{a} \cdot (\vec{a} \times \vec{b}) &amp;= (3, 0, 4) \cdot (-8, -5, 6) = -24 + 0 + 24 = 0, \\
    \vec{b} \cdot (\vec{a} \times \vec{b}) &amp;= (1, 2, 3) \cdot (-8, -5, 6) = - 8 - 10 + 18 = 0.
\end{align*}\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following function to the <em><strong>maths.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">cross</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="nx">a</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span>
<span class="w">    </span><span class="nx">a</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span>
<span class="w">    </span><span class="nx">a</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
<span class="w">  </span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">aCrossB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cross</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;a x b = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">printVector</span><span class="p">(</span><span class="nx">aCrossB</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;a . (a x b) = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">dot</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">aCrossB</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;b . (a x b) = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">dot</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">aCrossB</span><span class="p">));</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>a x b = [ -8.00, -5.00, 6.00 ]
a . (a x b) = 0
b . (a x b) = 0
</pre></div>
</div>
<p>Here we have also shown that the cross product of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> is perpendicular to both vectors.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrices">
<h2>Matrices<a class="headerlink" href="#matrices" title="Link to this heading">#</a></h2>
<p>Another type of mathematical object that is fundamental to computer graphics is the matrix. A matrix is a rectangular array of numbers.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    A =
    \begin{pmatrix}
        a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
        a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
        \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
        a_{m1} &amp; a_{m2} &amp; \cdots &amp; a_{mn}
    \end{pmatrix}
\end{align*}\end{split}\]</div>
<p>It is common to use uppercase characters for the name of a matrix and lowercase characters for the individual elements. The elements of a matrix are referenced by an <strong>index</strong> which is a pair of numbers, the first of which is the horizontal row number and the second is the vertical column number so <span class="math notranslate nohighlight">\(a_{ij}\)</span> is the element in row <span class="math notranslate nohighlight">\(i\)</span> and column <span class="math notranslate nohighlight">\(j\)</span> of the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>We refer to the size of a matrix by the number of rows by the number of columns. Here the matrix <span class="math notranslate nohighlight">\(A\)</span> has <span class="math notranslate nohighlight">\(m\)</span> rows and <span class="math notranslate nohighlight">\(n\)</span> columns, so we call this matrix a <span class="math notranslate nohighlight">\(m \times n\)</span> matrix. Computer graphics mostly works with <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrices (see <a class="reference internal" href="05_Transformations.html#transformations-section"><span class="std std-ref">Lab 5: Transformations</span></a> for why this is) so we will create a matrix class to define <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrices and perform operations on them.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following class declaration to the <em><strong>maths.js</strong></em> file.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// 4x4 Matrix class</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">Mat4</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="mf">16</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">identity</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">identity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="p">;</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">set</span><span class="p">(</span><span class="nx">values</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">values</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">print</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">4</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">8</span><span class="p">),</span>
<span class="w">        </span><span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">8</span><span class="p">),</span>
<span class="w">        </span><span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">8</span><span class="p">),</span>
<span class="w">        </span><span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">8</span><span class="p">),</span>
<span class="w">      </span><span class="p">];</span>
<span class="w">      </span><span class="nx">string</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;  [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">row</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; ]\n&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">string</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">copy</span><span class="w"> </span><span class="p">(</span><span class="nx">mat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">mat</span><span class="p">.</span><span class="nx">m</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Matrices</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nMatrices\n--------&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Mat4</span><span class="p">().</span><span class="nx">set</span><span class="p">([</span>
<span class="w">   </span><span class="mf">1</span><span class="p">,</span><span class="w">  </span><span class="mf">2</span><span class="p">,</span><span class="w">  </span><span class="mf">3</span><span class="p">,</span><span class="w">  </span><span class="mf">4</span><span class="p">,</span>
<span class="w">   </span><span class="mf">5</span><span class="p">,</span><span class="w">  </span><span class="mf">6</span><span class="p">,</span><span class="w">  </span><span class="mf">7</span><span class="p">,</span><span class="w">  </span><span class="mf">8</span><span class="p">,</span>
<span class="w">   </span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">11</span><span class="p">,</span><span class="w"> </span><span class="mf">12</span><span class="p">,</span>
<span class="w">  </span><span class="mf">13</span><span class="p">,</span><span class="w"> </span><span class="mf">14</span><span class="p">,</span><span class="w"> </span><span class="mf">15</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span>
<span class="p">]);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;A =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">A</span><span class="p">.</span><span class="nx">print</span><span class="p">());</span>
</pre></div>
</div>
</div>
<p>Here we have declared a class called <code class="docutils literal notranslate"><span class="pre">Mat4</span></code> inside which we have defined the following methods</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">constructor()</span></code> – the constructor method that defines a <span class="math notranslate nohighlight">\(4\times 4\)</span> identity matrix (we discuss identity matrices <a class="reference internal" href="#identity-matrix-section"><span class="std std-ref">below</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">identity()</span></code> – returns an identity matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set()</span></code> – sets the values of the matrix equal to 16 inputted values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">print()</span></code> – prints the matrix (when used with <code class="docutils literal notranslate"><span class="pre">console.log()</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">copy()</span></code> – makes a copy of the matrix (useful to avoid overwriting the matrix)</p></li>
</ul>
<p>We have then created a matrix object and set the values equal to the matrix below and printed the matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}A =
\begin{pmatrix}
  1 &amp; 2 &amp; 3 &amp; 4 \\
  5 &amp; 6 &amp; 7 &amp; 8 \\
  9 &amp; 10 &amp; 11 &amp; 12 \\
  13 &amp; 14 &amp; 15 &amp; 16
\end{pmatrix}.\end{split}\]</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Matrices
--------
A =
  [    1.00     2.00     3.00     4.00 ]
  [    5.00     6.00     7.00     8.00 ]
  [    9.00    10.00    11.00    12.00 ]
  [   13.00    14.00    15.00    16.00 ]
</pre></div>
</div>
<section id="matrix-transpose">
<span id="transpose-section"></span><h3>Matrix transpose<a class="headerlink" href="#matrix-transpose" title="Link to this heading">#</a></h3>
<p>The <strong>transpose</strong> of a matrix <span class="math notranslate nohighlight">\(A\)</span> is denoted by <span class="math notranslate nohighlight">\(A^\mathsf{T}\)</span> and is defined</p>
<div class="math notranslate nohighlight">
\[A_{ij}^\mathsf{T} = A_{ji}\]</div>
<p>i.e., the rows and columns of <span class="math notranslate nohighlight">\(A\)</span> are swapped so row <span class="math notranslate nohighlight">\(i\)</span> of <span class="math notranslate nohighlight">\(A\)</span> is column <span class="math notranslate nohighlight">\(i\)</span> of <span class="math notranslate nohighlight">\(A^\mathsf{T}\)</span>. For example, the matrix <span class="math notranslate nohighlight">\(A\)</span> we defined above</p>
<div class="math notranslate nohighlight">
\[\begin{split}A =
\begin{pmatrix}
  1 &amp; 2 &amp; 3 &amp; 4 \\
  5 &amp; 6 &amp; 7 &amp; 8 \\
  9 &amp; 10 &amp; 11 &amp; 12 \\
  13 &amp; 14 &amp; 15 &amp; 16
\end{pmatrix},\end{split}\]</div>
<p>then <span class="math notranslate nohighlight">\(A^\mathsf{T}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}A^\mathsf{T} =
\begin{pmatrix}
  1 &amp; 5 &amp; 9 &amp; 13 \\
  2 &amp; 6 &amp; 10 &amp; 14 \\
  3 &amp; 7 &amp; 11 &amp; 15 \\
  4 &amp; 8 &amp; 12 &amp; 16
\end{pmatrix}.\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following method definition to the matrix class.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">transpose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">tmp</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">tmp</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">tmp</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">];</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tmp</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">tmp</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">];</span><span class="w">  </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">];</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tmp</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">];</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">];</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tmp</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nA^T =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">A</span><span class="p">.</span><span class="nx">transpose</span><span class="p">().</span><span class="nx">print</span><span class="p">());</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>A^T =
  [    1.00     5.00     9.00    13.00 ]
  [    2.00     6.00    10.00    14.00 ]
  [    3.00     7.00    11.00    15.00 ]
  [    4.00     8.00    12.00    16.00 ]
</pre></div>
</div>
<p>So here we have transposed the matrix <span class="math notranslate nohighlight">\(A\)</span> and printed it. Note that the call <code class="docutils literal notranslate"><span class="pre">A.transpose()</span></code> has changed the elements in the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> so if we want to work with the original matrix we must first make a copy.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Edit the code used to print the transpose of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">AT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Mat4</span><span class="p">().</span><span class="nx">copy</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nA^T =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">AT</span><span class="p">.</span><span class="nx">transpose</span><span class="p">().</span><span class="nx">print</span><span class="p">());</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nA =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">A</span><span class="p">.</span><span class="nx">print</span><span class="p">());</span>
</pre></div>
</div>
</div>
<p>Here we have created a new matrix <code class="docutils literal notranslate"><span class="pre">AT</span></code> and copied the elements of <code class="docutils literal notranslate"><span class="pre">A</span></code> into it and printed the transpose of the new matrix. We have also printed the original <code class="docutils literal notranslate"><span class="pre">A</span></code> matrix to check that its elements are still the original values. Refresh your web browser and you should set the following.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>A^T =
  [    1.00     5.00     9.00    13.00 ]
  [    2.00     6.00    10.00    14.00 ]
  [    3.00     7.00    11.00    15.00 ]
  [    4.00     8.00    12.00    16.00 ]

A =
  [    1.00     2.00     3.00     4.00 ]
  [    5.00     6.00     7.00     8.00 ]
  [    9.00    10.00    11.00    12.00 ]
  [   13.00    14.00    15.00    16.00 ]
</pre></div>
</div>
</section>
<section id="matrix-multiplication">
<span id="matrix-multiplication-section"></span><h3>Matrix multiplication<a class="headerlink" href="#matrix-multiplication" title="Link to this heading">#</a></h3>
<p>Scalar multiplication of a matrix by a scalar is the same for matrices as it is for vectors. However, the multiplication of two matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is defined in a very specific way. If <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are two matrices then the element in row <span class="math notranslate nohighlight">\(i\)</span> and column <span class="math notranslate nohighlight">\(j\)</span> of the matrix <span class="math notranslate nohighlight">\(AB\)</span> is calculated using</p>
<div class="math notranslate nohighlight" id="equation-eq-matrix-multiplication">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-matrix-multiplication" title="Link to this equation">#</a></span>\[ [AB]_{ij} = \vec{a}_i \cdot \vec{b}_j, \]</div>
<p>Where <span class="math notranslate nohighlight">\(\vec{a}_i\)</span> is the vector formed from row <span class="math notranslate nohighlight">\(i\)</span> of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\vec{b}_j\)</span> is the vector formed from column <span class="math notranslate nohighlight">\(j\)</span> of <span class="math notranslate nohighlight">\(B\)</span>. In computer graphics we mainly work with <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrices, so consider the following matrix multiplication</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
  1 &amp; 2 &amp; 3 &amp; 4 \\
  5 &amp; 6 &amp; 7 &amp; 8 \\
  9 &amp; 10 &amp; 11 &amp; 12 \\
  13 &amp; 14 &amp; 15 &amp; 16
\end{pmatrix}
\begin{pmatrix}
  17 &amp; 18 &amp; 19 &amp; 20 \\
  21 &amp; 22 &amp; 23 &amp; 24 \\
  25 &amp; 26 &amp; 27 &amp; 28 \\
  29 &amp; 30 &amp; 31 &amp; 32
\end{pmatrix}\end{split}\]</div>
<p>For the element in row 2 and column 3, <span class="math notranslate nohighlight">\([AB]_{23}\)</span>, we have the dot product between row 2 of the left-hand matrix and column 3 of the right-hand matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
  \color{lightgray}1 &amp; \color{lightgray}2 &amp; \color{lightgray}3 &amp; \color{lightgray}4 \\
  5 &amp; 6 &amp; 7 &amp; 8 \\
  \color{lightgray}9 &amp; \color{lightgray}10 &amp; \color{lightgray}11 &amp; \color{lightgray}12 \\
  \color{lightgray}13 &amp; \color{lightgray}14 &amp; \color{lightgray}15 &amp; \color{lightgray}16
\end{pmatrix}
\begin{pmatrix}
  \color{lightgray}17 &amp; \color{lightgray}18 &amp; 19 &amp; \color{lightgray}20 \\
  \color{lightgray}21 &amp; \color{lightgray}22 &amp; 23 &amp; \color{lightgray}24 \\
  \color{lightgray}25 &amp; \color{lightgray}26 &amp; 27 &amp; \color{lightgray}28 \\
  \color{lightgray}29 &amp; \color{lightgray}30 &amp; 31 &amp; \color{lightgray}32
\end{pmatrix}\end{split}\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[(5, 6, 7, 8) \cdot (19, 23, 27, 31) = 5 \times 19 + 6 \times 23 + 7 \times 27 + 8 \times 31 = 670.\]</div>
<p>Doing similar for the other elements gives</p>
<div class="math notranslate nohighlight" id="equation-eq-matrix-multiplication-example">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-matrix-multiplication-example" title="Link to this equation">#</a></span>\[\begin{split} \begin{pmatrix}
  1 &amp; 2 &amp; 3 &amp; 4 \\
  5 &amp; 6 &amp; 7 &amp; 8 \\
  9 &amp; 10 &amp; 11 &amp; 12 \\
  13 &amp; 14 &amp; 15 &amp; 16
\end{pmatrix}
\begin{pmatrix}
  17 &amp; 18 &amp; 19 &amp; 20 \\
  21 &amp; 22 &amp; 23 &amp; 24 \\
  25 &amp; 26 &amp; 27 &amp; 28 \\
  29 &amp; 30 &amp; 31 &amp; 32
\end{pmatrix}
=
\begin{pmatrix}
   250 &amp;  260 &amp;  270 &amp;  280 \\
   618 &amp;  644 &amp;  670 &amp;  696 \\
   986 &amp; 1028 &amp; 1070 &amp; 1112 \\
  1354 &amp; 1412 &amp; 1470 &amp; 1528 \\
\end{pmatrix}\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following method definition to the matrix class.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">multiply</span><span class="p">(</span><span class="nx">mat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="mf">16</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">col</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">4</span><span class="p">;</span><span class="w"> </span><span class="nx">col</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">row</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">4</span><span class="p">;</span><span class="w"> </span><span class="nx">row</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">4</span><span class="p">;</span><span class="w"> </span><span class="nx">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="p">[</span><span class="nx">row</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">mat</span><span class="p">.</span><span class="nx">m</span><span class="p">[</span><span class="nx">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">col</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4</span><span class="p">];</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nx">result</span><span class="p">[</span><span class="nx">row</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">col</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sum</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Mat4</span><span class="p">().</span><span class="nx">set</span><span class="p">([</span>
<span class="w">  </span><span class="mf">17</span><span class="p">,</span><span class="w"> </span><span class="mf">18</span><span class="p">,</span><span class="w"> </span><span class="mf">19</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span>
<span class="w">  </span><span class="mf">21</span><span class="p">,</span><span class="w"> </span><span class="mf">22</span><span class="p">,</span><span class="w"> </span><span class="mf">23</span><span class="p">,</span><span class="w"> </span><span class="mf">24</span><span class="p">,</span>
<span class="w">  </span><span class="mf">25</span><span class="p">,</span><span class="w"> </span><span class="mf">26</span><span class="p">,</span><span class="w"> </span><span class="mf">27</span><span class="p">,</span><span class="w"> </span><span class="mf">28</span><span class="p">,</span>
<span class="w">  </span><span class="mf">29</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="mf">31</span><span class="p">,</span><span class="w"> </span><span class="mf">32</span>
<span class="p">]);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">AB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Mat4</span><span class="p">().</span><span class="nx">copy</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nB =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">B</span><span class="p">.</span><span class="nx">print</span><span class="p">());</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nAB =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">AB</span><span class="p">.</span><span class="nx">print</span><span class="p">());</span>
</pre></div>
</div>
</div>
<p>Refresh your web page, and you should see the following has been added</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>B =
  [   17.00    18.00    19.00    20.00 ]
  [   21.00    22.00    23.00    24.00 ]
  [   25.00    26.00    27.00    28.00 ]
  [   29.00    30.00    31.00    32.00 ]

AB =
  [  538.00   612.00   686.00   760.00 ]
  [  650.00   740.00   830.00   920.00 ]
  [  762.00   868.00   974.00  1080.00 ]
  [  874.00   996.00  1118.00  1240.00 ]
</pre></div>
</div>
<p>Hang on a minute, this matrix isn’t the same as the one from equation <a class="reference internal" href="#equation-eq-matrix-multiplication-example">(8)</a>. Our <code class="docutils literal notranslate"><span class="pre">multiply()</span></code> method hasn’t given us the result shown above. The reason for this is how the elements of a matrix are stored in memory.</p>
</section>
<section id="column-major-order">
<span id="column-major-order-section"></span><h3>Column-major order<a class="headerlink" href="#column-major-order" title="Link to this heading">#</a></h3>
<p>Linear memory is a contiguous block of addresses that can be sequentially accessed. So a 1D array is stored in adjacent memory locations. Since matrices are 2D we have a choice whether to store the elements in the rows or columns in adjacent locations. These are known as <strong>column-major order</strong> and <strong>row-major order</strong>. Consider the <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
    a &amp; b &amp; c &amp; d \\
    e &amp; f &amp; g &amp; h \\
    i &amp; j &amp; k &amp; l \\
    m &amp; n &amp; o &amp; p
\end{pmatrix}.\end{split}\]</div>
<p>Using column-major order this will be stored in the memory as</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/04_column_major_order.svg"><img alt="../_images/04_column_major_order.svg" src="../_images/04_column_major_order.svg" style="width: 650px;" />
</a>
</figure>
<p>i.e., we move down and across the matrix. Alternatively, using row-major order the matrix will be stored as</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/04_row_major_order.svg"><img alt="../_images/04_row_major_order.svg" src="../_images/04_row_major_order.svg" style="width: 650px;" />
</a>
</figure>
<p>i.e., we move across and down the matrix. <strong>WebGL uses column-major order</strong> because it is based upon OpenGL which was written for early GPUs that treated vertex data as column vectors. So a matrix containing vertices is stored column-by-column which means, when working with WebGL, we need to switch the rows and columns around when multiplying matrices. This is why our <code class="docutils literal notranslate"><span class="pre">multiply()</span></code> method produced the wrong result.</p>
<p>To output the matrix multiplication <span class="math notranslate nohighlight">\(AB\)</span> as we would expect it to appear, we can swap <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Edit the line that computes the matrix <code class="docutils literal notranslate"><span class="pre">AB</span></code> so that <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are swapped.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">AB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Mat4</span><span class="p">().</span><span class="nx">copy</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>Refresh your browser and you should now see that we have the matrix seen in equation <a class="reference internal" href="#equation-eq-matrix-multiplication-example">(8)</a>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>AB =
  [  250.00   260.00   270.00   280.00 ]
  [  618.00   644.00   670.00   696.00 ]
  [  986.00  1028.00  1070.00  1112.00 ]
  [ 1354.00  1412.00  1470.00  1528.00 ]
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When working with column-major ordering, matrix multiplication is read from right-to-left, so to calculate the multiplication <span class="math notranslate nohighlight">\(AB\)</span> we would reverse the order, i.e., <span class="math notranslate nohighlight">\(BA\)</span>.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Microsoft’s graphics library directX and Unreal Engine uses row-major order whilst WebGL, OpenGL, Vulkan (successor to OpenGL), Metal (Apple’s graphics library) and Unity all use column-major order. This means when porting code between the graphics libraries developers have to change all of their matrix calculations.</p>
</div>
</section>
<section id="the-identity-matrix">
<span id="identity-matrix-section"></span><h3>The Identity Matrix<a class="headerlink" href="#the-identity-matrix" title="Link to this heading">#</a></h3>
<p>The identity matrix is a special square matrix where all the elements are zero apart from the elements on the diagonal line from the top-left element down to the bottom-right element (known as the main diagonal). For example the <span class="math notranslate nohighlight">\(4 \times 4\)</span> identity matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}I =
\begin{pmatrix}
  1 &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}.\end{split}\]</div>
<p>The identity matrix is similar to the number 1 in that if we multiply any matrix by an identity matrix the result is unchanged. For example,</p>
<div class="math notranslate nohighlight">
\[\begin{split}IA =
\begin{pmatrix}
  1 &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
   1 &amp;  2 &amp;  3 &amp;  4 \\
   5 &amp;  6 &amp;  7 &amp;  8 \\
   9 &amp; 10 &amp; 11 &amp; 12 \\
  13 &amp; 14 &amp; 15 &amp; 16
\end{pmatrix}
=
\begin{pmatrix}
   1 &amp;  2 &amp;  3 &amp;  4 \\
   5 &amp;  6 &amp;  7 &amp;  8 \\
   9 &amp; 10 &amp; 11 &amp; 12 \\
  13 &amp; 14 &amp; 15 &amp; 16
\end{pmatrix}
= A.\end{split}\]</div>
</section>
<section id="matrix-inverse">
<h3>Matrix Inverse<a class="headerlink" href="#matrix-inverse" title="Link to this heading">#</a></h3>
<p>Whilst matrix multiplication is defined for certain matrices there is no way of dividing one matrix by another. However, for certain square matrices we can calculate an <strong>inverse matrix</strong> that performs a similar function to divide. Consider the division of two numbers, 4 and 2 say. If we wanted to divide 4 by two we could write</p>
<div class="math notranslate nohighlight">
\[ \frac{4}{2} = 2. \]</div>
<p>We could also write this division as the multiplication of <span class="math notranslate nohighlight">\(\dfrac{1}{2}\)</span> and 4</p>
<div class="math notranslate nohighlight">
\[ \frac{1}{2} \times 4 = 2.\]</div>
<p>Here we have shown that <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> is the <strong>multiplicative inverse</strong> of 2. A multiplicative inverse of a number <span class="math notranslate nohighlight">\(x\)</span> is denoted as <span class="math notranslate nohighlight">\(x^{-1}\)</span> and satisfies <span class="math notranslate nohighlight">\(x \times x^{-1} = 1\)</span>. The inverse of a matrix <span class="math notranslate nohighlight">\(A\)</span> is denoted by <span class="math notranslate nohighlight">\(A^{-1}\)</span> and satisfies <span class="math notranslate nohighlight">\(A^{-1} A = AA^{-1} = I\)</span> where <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix. For example, consider the matrix <span class="math notranslate nohighlight">\(C\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split} C = \begin{pmatrix}
  1  &amp;   3  &amp;   2  &amp;   1 \\
  1  &amp;   1  &amp;   2  &amp;   2 \\
  1  &amp;   3  &amp;   3  &amp;   2 \\
  3  &amp;   1  &amp;   3  &amp;   2 \\
\end{pmatrix}, \end{split}\]</div>
<p>which has the inverse</p>
<div class="math notranslate nohighlight">
\[\begin{split} C^{-1} = \begin{pmatrix}
  1 &amp; 1/2 &amp; -5/4 &amp; 1/4 \\
  1 &amp; 1/2 &amp; -3/4 &amp; -1/4 \\
  -2 &amp; -2 &amp; 5/2 &amp; 1/2 \\
  1 &amp; 2 &amp; -3/2 &amp; -1/2
\end{pmatrix}. \end{split}\]</div>
<p>We can check whether this is the inverse of <span class="math notranslate nohighlight">\(A\)</span> by calculating <span class="math notranslate nohighlight">\(A^{-1}A\)</span> (or <span class="math notranslate nohighlight">\(A A^{-1}\)</span>)</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align*}
    C^{-1} C &amp;=
  \begin{pmatrix}
    1  &amp;   3  &amp;   2  &amp;   1 \\
    1  &amp;   1  &amp;   2  &amp;   2 \\
    1  &amp;   3  &amp;   3  &amp;   2 \\
    3  &amp;   1  &amp;   3  &amp;   2 \\
  \end{pmatrix}
  \begin{pmatrix}
    1 &amp; 1/2 &amp; -5/4 &amp; 1/4 \\
    1 &amp; 1/2 &amp; -3/4 &amp; -1/4 \\
    -2 &amp; -2 &amp; 5/2 &amp; 1/2 \\
    1 &amp; 2 &amp; -3/2 &amp; -1/2
  \end{pmatrix}
  =
  \begin{pmatrix}
   1 &amp; 0 &amp; 0 &amp; 0  \\
   0 &amp; 1 &amp; 0 &amp; 0 \\
   0 &amp; 0 &amp; 1 &amp; 0 \\
   0 &amp; 0 &amp; 0 &amp; 1
  \end{pmatrix}.
\end{align*} \end{split}\]</div>
<p>So this shows that <span class="math notranslate nohighlight">\(C^{-1}\)</span> is the correct inverse matrix of <span class="math notranslate nohighlight">\(C\)</span>. Calculating the inverse of a matrix is quite involved process and outside the scope of this course.</p>
<div class="admonition-task admonition">
<p class="admonition-title">Task</p>
<p>Add the following method to the Matrix class (you may wish to use copy and paste here).</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">inverse</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">m</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">inv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">],</span>
<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">],</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span>
<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span>

<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">],</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">],</span>
<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span>

<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">],</span>
<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">],</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">],</span>
<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">],</span>

<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">],</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">],</span>
<span class="w">    </span><span class="o">-</span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">14</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">],</span>
<span class="w">    </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span>
<span class="w">  </span><span class="p">]);</span>

<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">det</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">inv</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">inv</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">inv</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">inv</span><span class="p">[</span><span class="mf">12</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">det</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Matrix is singular, no inverse exists&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">det</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">det</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">16</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">inv</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="nx">det</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">inv</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add enter the following code to the <em><strong>vectors_and_matrices.js</strong></em> file.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Mat4</span><span class="p">().</span><span class="nx">set</span><span class="p">([</span>
<span class="w">  </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">  </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">  </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">  </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span>
<span class="p">]);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">invC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Mat4</span><span class="p">().</span><span class="nx">copy</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">inverse</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\nC =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">C</span><span class="p">.</span><span class="nx">print</span><span class="p">());</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\ninv(C) =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">invC</span><span class="p">.</span><span class="nx">print</span><span class="p">());</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;\ninv(C)C =\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">invC</span><span class="p">.</span><span class="nx">multiply</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">print</span><span class="p">());</span>
</pre></div>
</div>
</div>
<p>Here we have computed and printed the inverse of the matrix <code class="docutils literal notranslate"><span class="pre">C</span></code> (remembering to take a copy) as well printing the matrix multiplication of <code class="docutils literal notranslate"><span class="pre">C</span></code>, and it’s inverse to check that we get an identity matrix. Refresh your browser, and you should see the following.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>C =
  [    1.00     3.00     2.00     1.00 ]
  [    1.00     1.00     2.00     2.00 ]
  [    1.00     3.00     3.00     2.00 ]
  [    3.00     1.00     3.00     2.00 ]

inv(C) =
  [    1.00     0.50    -1.25     0.25 ]
  [    1.00     0.50    -0.75    -0.25 ]
  [   -2.00    -2.00     2.50     0.50 ]
  [    1.00     2.00    -1.50    -0.50 ]

inv(C)C =
  [    1.00     0.00     0.00     0.00 ]
  [    0.00     1.00     0.00     0.00 ]
  [    0.00     0.00     1.00     0.00 ]
  [    0.00     0.00     0.00     1.00 ]
</pre></div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="exercises">
<span id="vectors-exercises"></span><h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<ol class="arabic">
<li><p>Three points have the co-ordinates <span class="math notranslate nohighlight">\(A = (5, 1, 3)\)</span>, <span class="math notranslate nohighlight">\(B = (10, 7, 4)\)</span> and <span class="math notranslate nohighlight">\(C = (0, 5, -3)\)</span>. Use pen and paper to calculate the following:</p>
<p>(a) The vector <span class="math notranslate nohighlight">\(\vec{p}\)</span> that points from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(B\)</span>;<br>
(b) The vector <span class="math notranslate nohighlight">\(\vec{q}\)</span> that points from <span class="math notranslate nohighlight">\(B\)</span> to <span class="math notranslate nohighlight">\(C\)</span>;<br>
(c) The vector <span class="math notranslate nohighlight">\(\vec{r}\)</span> that points from <span class="math notranslate nohighlight">\(C\)</span> to <span class="math notranslate nohighlight">\(A\)</span>;<br>
(d) The length of the vector <span class="math notranslate nohighlight">\(\vec{p}\)</span>;<br>
(e) A unit vector that points in the direction of the vector <span class="math notranslate nohighlight">\(\vec{q}\)</span>;<br>
(f) The dot product <span class="math notranslate nohighlight">\(\vec{p} \cdot \vec{q}\)</span>;<br>
(g) The cross product <span class="math notranslate nohighlight">\(\vec{q} \times \vec{r}\)</span>.</p>
</li>
<li><p>Repeat exercise 1 using your methods from the <em><strong>maths.js</strong></em> file.</p></li>
<li><p>The three matrices <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(C\)</span> are defined by</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align*}
    A &amp;= \begin{pmatrix} -1 &amp; 3 \\ 2 &amp; -5 \end{pmatrix}, &amp;
    B &amp;= \begin{pmatrix} 0 &amp; 2 \\ 7 &amp; 1 \end{pmatrix}, &amp;
    C &amp;= \begin{pmatrix} 3 &amp; 2 \\ -3 &amp; -4 \end{pmatrix}.
\end{align*} \end{split}\]</div>
<p>   Use pen and paper to calculate the following:</p>
<p>   (a) <span class="math notranslate nohighlight">\(AB\)</span>;<br>
   (b) <span class="math notranslate nohighlight">\(ABC\)</span>;<br>
   (c) <span class="math notranslate nohighlight">\(B^\mathsf{T}A^\mathsf{T}\)</span>.<br></p>
<ol class="arabic simple" start="4">
<li><p>A transformation can be applied to a vector by matrix multiplication. If <span class="math notranslate nohighlight">\(T\)</span> is a transformation matrix and <span class="math notranslate nohighlight">\(\vec{v}\)</span> is a vector then the transformed vector is <span class="math notranslate nohighlight">\(T \vec{v}\)</span>. Given the following transformation matrices and vector</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
  S &amp;= \begin{pmatrix}
    2 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 2 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 2 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1
  \end{pmatrix}, &amp;
  T &amp;= \begin{pmatrix}
    1 &amp; 0 &amp; 0 &amp; 3 \\
    0 &amp; 1 &amp; 0 &amp; 2 \\
    0 &amp; 0 &amp; 1 &amp; -1 \\
    0 &amp; 0 &amp; 0 &amp; 1
  \end{pmatrix}, &amp;
  \vec{v} = \begin{pmatrix} 5 \\ 8 \\ 10 \\ 1 \end{pmatrix},
\end{align*}\end{split}\]</div>
<p>   use pen and paper to calculate the following transformations:</p>
<p>   (a)   <span class="math notranslate nohighlight">\(S \, \vec{v}\)</span>;<br>
   (b)   <span class="math notranslate nohighlight">\(T \, \vec{v}\)</span>;<br>
   (c)   <span class="math notranslate nohighlight">\(T\,S\,\vec{v}\)</span>.<br></p>
<p>   For each one, describe what effect the transformation has on <span class="math notranslate nohighlight">\(\vec{v}\)</span>.</p>
<!-- ````{dropdown} Solutions
1. (a) &emsp; $\vec{p} = (5, 6, 1)$ <br>
   (b) &emsp; $\vec{q} = (-10, -2, -7)$ <br>
   (c) &emsp; $\vec{r} = (5, -4, 6)$ <br>
   (d) &emsp; $\| \vec{p} \| = 7.8740$ <br>
   (e) &emsp; $\hat{q} = (-0.8085,   -0.1617,   -0.5659)$ <br>
   (f) &emsp; $\vec{p} \cdot \vec{q} = -69$ <br>
   (g) &emsp; $\vec{q} \times \vec{r} = (-40, 25, 50)$ <br>

2.
```javascript
// Exercise 2
console.log("\nExercise 2\n----------");

const A1 = new Float32Array([5, 1, 3]);
const B1 = new Float32Array([10, 7, 4]);
const C1 = new Float32Array([0, 5, -3]);

p = subtractVectors(B1, A1);
printVector(p, "(a) p");
q = subtractVectors(C1, B1);
printVector(q, "(b) q");
r = subtractVectors(A1, C1);
printVector(r, "(c) r");
console.log("(d) length(p) = " + length(p));
printVector(normalize(q), "(e) qHat")
console.log("(f) p . q = " + dot(p, q));
printVector(cross(q, r), "(g) q x r")
```

```text
Exercise 2
----------
(a) p = [ 5.0000, 6.0000, 1.0000 ]
(b) q = [ -10.0000, -2.0000, -7.0000 ]
(c) r = [ 5.0000, -4.0000, 6.0000 ]
(d) length(p) = 7.874007874011811
(e) qHat = [ -0.8085, -0.1617, -0.5659 ]
(f) p . q = -69
(g) q x r = [ -40.0000, 25.0000, 50.0000 ]
```

3. (a) &emsp; $AB = \begin{pmatrix} 21 & 1 \\ -35 & -1 \end{pmatrix}$<br>
   (b) &emsp; $ABC = \begin{pmatrix} 60 & 38 \\ -102 & -66 \end{pmatrix}$<br>
   (c) &emsp; $B^\textsf{T} A^\textsf{T} = \begin{pmatrix} 21 & -35 \\ 1 & -1 \end{pmatrix}$

4. (a) &emsp; $S \vec{v} = \begin{pmatrix} 10 \\ 16 \\ 20 \\ 1 \end{pmatrix}$<br>
    &emsp; The first three elements of $\vec{v}$ have been scaled up by a factor of 2, i.e., $\begin{pmatrix} 2 \times 10 \\ 2 \times 16 \\ 2 \times 20 \\ 1 \end{pmatrix}$.<br>
   (b) &emsp; $T \vec{v} = \begin{pmatrix} 8 \\ 10 \\ 9 \\ 1 \end{pmatrix}$<br>
   &emsp; The first three elements of $\vec{v}$ have been increased by 3, 2 and $-$1 respectively, i.e., $\begin{pmatrix} 5 + 3 \\ 8 + 2 \\ 10 - 1 \\ 1 \end{pmatrix}$.<br>
   (c) &emsp; $T \, S \, \vec{v} = \begin{pmatrix} 13 \\ 18 \\ 19 \\ 1 \end{pmatrix}$
   &emsp; The first three elements of $\vec{v}$ have been scaled up by a factor or 2 and then increased by 3, 2 and $-$1 respectively, i.e., $\begin{pmatrix} 2 \times 5 + 3 \\ 2 \times 8 + 2 \\ 2 \times 10 - 1 \\ 1\end{pmatrix}$.
```` -->
</section>
<hr class="docutils" />
<section id="video-walkthrough">
<h2>Video Walkthrough<a class="headerlink" href="#video-walkthrough" title="Link to this heading">#</a></h2>
<iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/9Ju2yfozZ6o?si=mZ5lOq2D3NzL9-2X" title="YouTube video player"
  frameborder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
  referrerpolicy="strict-origin-when-cross-origin"
  allowfullscreen
></iframe>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./_pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03_Textures.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 3: Textures</p>
      </div>
    </a>
    <a class="right-next"
       href="05_Transformations.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 5: Transformations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-addition-and-subtraction">Vector addition and subtraction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplication-by-a-scalar">Multiplication by a scalar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-magnitude">Vector magnitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-vectors">Unit vectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dot-product">The dot product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-cross-product">The cross product</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices">Matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-transpose">Matrix transpose</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-multiplication">Matrix multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-major-order">Column-major order</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-identity-matrix">The Identity Matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-inverse">Matrix Inverse</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-walkthrough">Video Walkthrough</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Jon Shiach
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>