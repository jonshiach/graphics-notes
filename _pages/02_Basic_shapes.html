
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 2: Drawing Basic Shapes in WebGL &#8212; Computer Graphics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"vec": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_pages/02_Basic_shapes';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 3: Textures" href="03_Textures.html" />
    <link rel="prev" title="Lab 1: Introduction to JavaScript" href="01_intro_to_javascript.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Computer Graphics - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Computer Graphics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Contents
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preliminaries</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="P_Core_concepts.html">Core Computer Graphics Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="P_Software.html">Visual Studio Code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_intro_to_javascript.html">Lab 1: Introduction to JavaScript</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 2: Drawing Basic Shapes in WebGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_Textures.html">Lab 3: Textures</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_Vectors_and_matrices.html">Lab 4: Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_Transformations.html">Lab 5: Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_3D_worlds.html">Lab 6: 3D Worlds</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_Moving_the_camera.html">Lab 7: Moving the Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_Lighting.html">Lab 8: Lighting</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_Normal_mapping.html">Lab 9: Normal Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Quaternions.html">Lab 10: Quaternions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A1_Complex_numbers_and_quaternions.html">Appendix A: Complex Numbers and Quaternions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jonshiach/graphics-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jonshiach/graphics-notes/issues/new?title=Issue%20on%20page%20%2F_pages/02_Basic_shapes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_pages/02_Basic_shapes.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 2: Drawing Basic Shapes in WebGL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-html-and-javascript-files">Setup HTML and JavaScript Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#draw-a-red-triangle">Draw a Red Triangle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-triangle-co-ordinates">Define the Triangle Co-ordinates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-vertex-buffer-object-vbo-for-the-triangle">Create a Vertex Buffer Object (VBO) for the Triangle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-and-compile-the-vertex-shader">Write and Compile the Vertex Shader</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-and-compile-the-fragment-shader">Write and Compile the Fragment Shader</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#link-the-shaders-into-a-webgl-program">Link the Shaders into a WebGL Program</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#draw-the-triangle">Draw the Triangle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-used-to-draw-the-triangle">Steps Used to Draw the Triangle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#webgl-utility-functions">WebGL Utility Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colours">Colours</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-and-fragment-shaders">Vertex and Fragment Shaders</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-colours">Vertex Colours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-shapes">More Shapes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-array-objects-vao">Vertex Array Objects (VAO)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#element-buffer-objects">Element Buffer Objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-walkthrough">Video walkthrough</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-2-drawing-basic-shapes-in-webgl">
<span id="basic-shapes-section"></span><h1>Lab 2: Drawing Basic Shapes in WebGL<a class="headerlink" href="#lab-2-drawing-basic-shapes-in-webgl" title="Link to this heading">#</a></h1>
<p>We are going to begin our study of WebGL with the simplest complete example: drawing a single triangle. This “hello triangle” is the computer graphics version of the classic “hello world!” example.</p>
<section id="setup-html-and-javascript-files">
<h2>Setup HTML and JavaScript Files<a class="headerlink" href="#setup-html-and-javascript-files" title="Link to this heading">#</a></h2>
<p>To start with we need two files, an HTML file that includes a canvas element which acts as a rendering surface for WebGL, and JavaScript file that controls everything that happens inside the canvas using the WebGL API.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Create a folder called <em><strong>Lab 2 Basic Shapes</strong></em> inside which create an HTML file called <em><strong>index.html</strong></em> and paste in the following</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;!doctype html&gt;

&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
    &lt;title&gt;Lab 2 - Basic Shapes in WebGL&lt;/title&gt;
    &lt;style&gt;
      html, head, body {
        margin: 0;
        padding: 10px;
        background-color: #000;
      }
      #canvas {
        width: 800px;
        height: 600px;
        background-color: #8AcE00;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;canvas&quot; width=&quot;800px&quot; height=&quot;600px&quot;&gt;&lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>Start a live server by clicking on “Go Live” in the bottom right-hand corner of the window.</p>
</div>
<p>If everything has gone to plan you should be looking at a web browser with a page titled “Lab 2 - Basic Shapes in WebGL” that displays a canvas element that is 800 pixels wide by 600 pixels high which is a particularly lurid shade of green. The reason for this horrible colour is that we will be clearing the canvas in our WebGL app so if we see this green colour we know something has gone wrong.</p>
<figure class="align-default" id="canvas-figure">
<a class="reference internal image-reference" href="../_images/02_Canvas.png"><img alt="../_images/02_Canvas.png" src="../_images/02_Canvas.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The lurid green canvas element.</span><a class="headerlink" href="#canvas-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Inside your <em><strong>Lab 2 Basic Shapes</strong></em> folder, create a JavaScript file <em><strong>basic_shapes.js</strong></em> that contains the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Main function</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="c1">// Setup WebGL</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">canvas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">&quot;webgl2&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;WebGL not supported&quot;</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">viewport</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">clearColor</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">COLOR_BUFFER_BIT</span><span class="p">);</span>

<span class="p">}</span>

<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
</div>
<p>Here we have created our main function <code class="docutils literal notranslate"><span class="pre">main()</span></code> inside which we have set up the WebGL canvas. Some functions used here are defined below</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gl.viewport(0,</span> <span class="pre">0,</span> <span class="pre">canvas.width,</span> <span class="pre">canvas.height);</span></code> – Defines the rectangular area of the canvas where rendering will take place that maps to the normalized device co-ordinates (-1 to 1 in the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> axes). Here our viewport fills the <code class="docutils literal notranslate"><span class="pre">&lt;canvas&gt;</span></code> element.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.clearColor(0.2,</span> <span class="pre">0.2,</span> <span class="pre">0.2,</span> <span class="pre">1.0);</span></code> – Defines the background colour. Colours are defined using RGBA values (Red, Green, Blue and Alpha) so here our background is dark grey.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.clear(gl.COLOR_BUFFER_BIT);</span></code> – Clears the specified buffer, in this case it’s the colour buffer.</p></li>
</ul>
<p>Refresh your web browser (this is done by the live server whenever you save a file), and you should still see that the horrible lurid green background. But hang on, haven’t we defined our background colour to be dark grey? The reason for this is that we haven’t embedded the JavaScript file into our HTML file.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Edit the <code class="docutils literal notranslate"><span class="pre">&lt;body&gt;</span></code> tag near the bottom of the <em><strong>index.html</strong></em> file so that it looks like the following</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;body&gt;
  &lt;canvas id=&quot;canvas&quot; width=&quot;800px&quot; height=&quot;600px&quot;&gt;&lt;/canvas&gt;
  &lt;script src=&quot;basic_shapes.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
</pre></div>
</div>
</div>
<p>Now if you refresh your browser you should see a dark grey background. If something has gone wrong, and you still see the green background, open up the JavaScript console (if you are using Chrome then press <kbd>CTRL</kbd> + <kbd>SHIFT</kbd> + <kbd>J</kbd> or <kbd>⌥</kbd> + <kbd>⌘</kbd> + <kbd>J</kbd> on a Mac) and it should give you an indication of what has gone wrong. The life of a graphics programmer is mostly problem-solving and debugging, so get used to doing this.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_colour_buffer.png"><img alt="../_images/02_colour_buffer.png" src="../_images/02_colour_buffer.png" style="width: 80%;" />
</a>
</figure>
</section>
<hr class="docutils" />
<section id="draw-a-red-triangle">
<h2>Draw a Red Triangle<a class="headerlink" href="#draw-a-red-triangle" title="Link to this heading">#</a></h2>
<p>The first shape we are going to draw with WebGL is a red triangle. We start with a triangle because it is the fundamental building block of modern computer graphics. Every complex 3D model, character, environment, object etc. are ultimately made from many small triangles, and WebGL (like all graphics hardware) is designed to process triangles extremely efficiently.</p>
<p>Triangles are used in computer graphics for several important reasons:</p>
<ul class="simple">
<li><p><strong>A triangle is always flat.</strong>
Any three points in space define a single plane, which means a triangle cannot become bent or warped. This makes it reliable for representing surfaces.</p></li>
<li><p><strong>They are the simplest possible polygon.</strong>
With only three vertices, triangles are easy for the GPU to transform, rasterise, and shade. All calculations, such as clipping and interpolation, are simpler with triangles than with more complex shapes.</p></li>
<li><p><strong>Graphics hardware is optimized for triangles.</strong>
Modern GPUs expect triangles as input, and even if you provide quads or other polygons, the hardware will convert them into triangles internally.</p></li>
<li><p><strong>Any shape can be built from triangles.</strong>
Complex models and smooth surfaces can be approximated by dividing them into many small triangles, a process known as tessellation. This allows triangles to represent everything from simple shapes to highly detailed 3D geometry.</p></li>
<li><p><strong>Interpolation works cleanly across triangles.</strong>
Colours, textures, normals, and depth all interpolate smoothly inside a triangle using barycentric co-ordinates, which ensures correct shading and rendering.</p></li>
</ul>
<section id="define-the-triangle-co-ordinates">
<span id="triangle-coordinates-section"></span><h3>Define the Triangle Co-ordinates<a class="headerlink" href="#define-the-triangle-co-ordinates" title="Link to this heading">#</a></h3>
<p>Our triangle will have co-ordinates at <span class="math notranslate nohighlight">\((-0.5, -0.5, 0)\)</span> (lower-left vertex), <span class="math notranslate nohighlight">\((0.5, -0.5, 0)\)</span> (lower-right vertex) and <span class="math notranslate nohighlight">\((0, 0.5, 0)\)</span> (top vertex).</p>
<figure class="align-default" id="triangle-figure">
<a class="reference internal image-reference" href="../_images/02_Triangle.svg"><img alt="../_images/02_Triangle.svg" src="../_images/02_Triangle.svg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">The vertex co-ordinates for the red triangle example.</span><a class="headerlink" href="#triangle-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following after we have cleared the canvas.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define triangle vertices</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">  </span><span class="c1">// x    y    z</span>
<span class="w">  </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0       2</span>
<span class="w">   </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 1     /   \</span>
<span class="w">   </span><span class="mf">0.0</span><span class="p">,</span><span class="w">  </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2    0 --- 1</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<p>Here we have defined an array called <code class="docutils literal notranslate"><span class="pre">vertices</span></code> containing 9 values for the co-ordinates of the 3 triangle vertices. WebGL works best with 32-bit floats, and the default JavaScript float precision is 64-bit, so we use the <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">Float32Array()</span></code> command to convert these into 32-bit float array.</p>
</section>
<section id="create-a-vertex-buffer-object-vbo-for-the-triangle">
<span id="lab01-triangle-buffer"></span><h3>Create a Vertex Buffer Object (VBO) for the Triangle<a class="headerlink" href="#create-a-vertex-buffer-object-vbo-for-the-triangle" title="Link to this heading">#</a></h3>
<p>The data in the <code class="docutils literal notranslate"><span class="pre">vertices</span></code> array is stored in the CPU (RAM) and not in the GPU. To move data across to the GPU we create a WebGL buffer object known as a <strong>Vertex Buffer Object (VBO)</strong> and copy in the data.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following after we have defined the triangle vertices array.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create a VBO for the triangle</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">vbo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createBuffer</span><span class="p">();</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">vbo</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bufferData</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">vertices</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">STATIC_DRAW</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>The commands used here are explained below</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">vbo</span> <span class="pre">=</span> <span class="pre">gl.createBuffer();</span></code> – Creates a buffer object on the GPU.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.bindBuffer(gl.ARRAY_BUFFER,</span> <span class="pre">vbo);</span></code> – Binds our VBO to an array buffer so that WebGL knows where to send the data. The word <em>bind</em> in graphics programming means to make it the currently active resource for a particular purpose so subsequent WebGL operations affect it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.bufferData(gl.ARRAY_BUFFER,</span> <span class="pre">vertices,</span> <span class="pre">gl.STATIC_DRAW);</span></code> – Copies the data from the <code class="docutils literal notranslate"><span class="pre">vertices</span></code> array into the VBO which is the currently bound buffer. The <code class="docutils literal notranslate"><span class="pre">gl.STATIC_DRAW</span></code> input is a performance hint to WebGL, here we are saying that that triangle vertices will not change.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.bindBuffer(gl.ARRAY_BUFFER,</span> <span class="pre">null);</span></code> Here we unbind the current array buffer, so no subsequent commands will mistakenly affect it.</p></li>
</ul>
</section>
<section id="write-and-compile-the-vertex-shader">
<span id="vertex-shader-section"></span><h3>Write and Compile the Vertex Shader<a class="headerlink" href="#write-and-compile-the-vertex-shader" title="Link to this heading">#</a></h3>
<p>The next step is create a shader program that runs on the GPU and uses WebGL to determine which pixels on the display are to be rendered and in what colour. This shader program comprises two separate programs known as “shaders”: the <strong>vertex shader</strong> and the <strong>fragment shader</strong>. Shaders are written in <strong>GLSL (webGL Shader Language)</strong> which is similar to C.</p>
<p>The vertex shader is called once for each vertex and transforms the vertex co-ordinates from model space (the local object co-ordinates) to the clip space that defines the region that is displayed on the canvas. We have defined our triangle using co-ordinates between <span class="math notranslate nohighlight">\(-1\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, so they are already in clip space and our vertex shader just needs to output each vertex. The shader code for a simple vertex shader is</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#version 300 es</span>
<span class="n">precision</span><span class="w"> </span><span class="n">mediump</span><span class="w"> </span><span class="kt">float</span><span class="p">;</span>

<span class="n">in</span><span class="w"> </span><span class="n">vec3</span><span class="w"> </span><span class="n">aPosition</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">gl_Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec4</span><span class="p">(</span><span class="n">aPosition</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This code is explained below</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#version</span> <span class="pre">300</span> <span class="pre">es</span></code> – Tells the shader we are using GLSL ES 3.00, the shader language used with WebGL 2.0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span> <span class="pre">mediump</span> <span class="pre">float;</span></code> – Sets the default float precision to medium (16-bit).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">vec3</span> <span class="pre">aPosition;</span></code> – Tells the shader that we are inputting a 3-element vector for the vertex position (the <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">aPosition</span></code> is short for attribute).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl_Position</span> <span class="pre">=</span> <span class="pre">vec4(aPosition,</span> <span class="pre">1.0);</span></code> – Outputs a 4-element vector for the clip space co-ordinates of the vertex (there reason why it’s a 4-element vector will be covered later when we look at transformations). The <code class="docutils literal notranslate"><span class="pre">gl_Position</span></code> variable is a required output of every vertex shader.</p></li>
</ul>
<p>The simplest way of entering shader code into our JavaScript file is to define it as a multiline string.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following at the top of the <em><strong>basic_shapes.js</strong></em> file. Note the use of backticks <code class="docutils literal notranslate"><span class="pre">`...`</span></code> to define the string using a literal so that we can use a multiline string.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define vertex shader</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">vertexShaderSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="sb">`#version 300 es</span>
<span class="sb">precision mediump float;</span>

<span class="sb">in vec3 aPosition;</span>

<span class="sb">void main() {</span>
<span class="sb">  gl_Position = vec4(aPosition, 1.0);</span>
<span class="sb">}`</span><span class="p">;</span>
</pre></div>
</div>
<p>Now add the following after we have set up the WebGL canvas.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Compile vertex shader</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">vertexShader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">VERTEX_SHADER</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">shaderSource</span><span class="p">(</span><span class="nx">vertexShader</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexShaderSource</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">vertexShader</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderParameter</span><span class="p">(</span><span class="nx">vertexShader</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">COMPILE_STATUS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Error compiling vertex shader:\n`</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderInfoLog</span><span class="p">(</span><span class="nx">vertexShader</span><span class="p">));</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">deleteShader</span><span class="p">(</span><span class="nx">vertexShader</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>As well as defining a string for the vertex shader code, we then create a vertex shader object, attach the shader code to it and compile it. There’s no easy way to check for errors in shader code, so it is good practice to do a check to see if it has compiled ok, if not a message is logged to the console.</p>
</section>
<section id="write-and-compile-the-fragment-shader">
<span id="lab01-fragment-shader"></span><h3>Write and Compile the Fragment Shader<a class="headerlink" href="#write-and-compile-the-fragment-shader" title="Link to this heading">#</a></h3>
<p>The other shader we need to write is the fragment shader. This takes in information on a fragment that has been identified as being part of the primitive (i.e., triangle) and determines the colour that it will be rendered. We are going to render all fragments in the triangle as red, so the fragment shader code is as follows.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#version 300 es</span>
<span class="n">precision</span><span class="w"> </span><span class="n">mediump</span><span class="w"> </span><span class="kt">float</span><span class="p">;</span>

<span class="n">out</span><span class="w"> </span><span class="n">vec4</span><span class="w"> </span><span class="n">fragColour</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fragColour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec4</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is similar to the vertex shader with a couple of exceptions. The vertex shader has a required output of <code class="docutils literal notranslate"><span class="pre">gl_Position</span></code>, so this doesn’t need to be declared, fragment shaders can have a number of outputs, so we need to declare these. Here we have declared an output of a 4-element vector using <code class="docutils literal notranslate"><span class="pre">out</span> <span class="pre">vec4</span> <span class="pre">fragColour;</span></code>. Within the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function, we set the output vector to <span class="math notranslate nohighlight">\((1, 0, 0, 1)\)</span>, i.e., all Red, no Blue and no Green components and the Alpha value is set to 1 so that it is opaque.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following after we have defined the vertex shader.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define fragment shader</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">fragmentShaderSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="sb">`#version 300 es</span>
<span class="sb">precision mediump float;</span>

<span class="sb">out vec4 fragColour;</span>

<span class="sb">void main() {</span>
<span class="sb">  fragColour = vec4(1.0, 0.0, 0.0, 1.0);</span>
<span class="sb">}`</span><span class="p">;</span>
</pre></div>
</div>
<p>And add the following after we have compiled the vertex shader.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Compile fragment shader</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">fragmentShader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">FRAGMENT_SHADER</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">shaderSource</span><span class="p">(</span><span class="nx">fragmentShader</span><span class="p">,</span><span class="w"> </span><span class="nx">fragmentShaderSource</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">fragmentShader</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderParameter</span><span class="p">(</span><span class="nx">fragmentShader</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">COMPILE_STATUS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Error compiling fragment shader:\n`</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderInfoLog</span><span class="p">(</span><span class="nx">fragmentShader</span><span class="p">));</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">deleteShader</span><span class="p">(</span><span class="nx">fragmentShader</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>This code is very similar to the one used for the vertex shader. Later we will be using a helper function to compile the shaders.</p>
</section>
<section id="link-the-shaders-into-a-webgl-program">
<span id="lab01-webgl-program"></span><h3>Link the Shaders into a WebGL Program<a class="headerlink" href="#link-the-shaders-into-a-webgl-program" title="Link to this heading">#</a></h3>
<p>The next step is to create a WebGL program and link the vertex and fragment shader to it. In doing this it manages the inputs and outputs, attributes and uniforms between our two shaders.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add the following after we have compiled the vertex and fragment shaders.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create WebGL shader program and link the vertex and fragment shaders</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createProgram</span><span class="p">();</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">attachShader</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexShader</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">attachShader</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">fragmentShader</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">linkProgram</span><span class="p">(</span><span class="nx">program</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getProgramParameter</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">LINK_STATUS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Failed to link WebGL program : </span><span class="si">${</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getProgramInfoLog</span><span class="p">(</span><span class="nx">program</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The commands used here are similar to those used for the vertex and fragment shader. Rather than compiling a shader we simply link the vertex and fragment shaders into a single WebGL program that we have called <code class="docutils literal notranslate"><span class="pre">program</span></code> using the <code class="docutils literal notranslate"><span class="pre">gl.linkProgram()</span></code> function. We have also done a check to see if the linking has been successful.</p>
</section>
<section id="draw-the-triangle">
<span id="lab01-draw-triangle"></span><h3>Draw the Triangle<a class="headerlink" href="#draw-the-triangle" title="Link to this heading">#</a></h3>
<p>So far we have done a fair bit of work creating a buffer object for the triangle vertices, written and compiled the vertex and fragment shader and linked these into a WebGL program. But we haven’t drawn anything yet! To do this we need to tell WebGL which shader program to use, tell it how to interpret the vertex data and then tell it to draw the triangle.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following after we have created the WebGL shader program.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set the shader program</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">useProgram</span><span class="p">(</span><span class="nx">program</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">gl.useProgram()</span></code> function tells WebGL which shader program to use. It will use the currently selected program until told differently by another call to this function.</p>
<p>Earlier we created the VBO in the GPU and copied across our vertex data. We now need to tell WebGL where this data is and how to read it, so it can work its magic with the shaders.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following after you have set the shader program.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Tell WebGL how to read data from the vertex buffer  </span>
<span class="kd">const</span><span class="w"> </span><span class="nx">positionLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">getAttribLocation</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;aPosition&quot;</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">positionLocation</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">vbo</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span>
<span class="w">  </span><span class="nx">positionLocation</span><span class="p">,</span><span class="w"> </span><span class="c1">// index</span>
<span class="w">  </span><span class="mf">3</span><span class="p">,</span><span class="w">                </span><span class="c1">// size</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span><span class="w">         </span><span class="c1">// type</span>
<span class="w">  </span><span class="kc">false</span><span class="p">,</span><span class="w">            </span><span class="c1">// normalized</span>
<span class="w">  </span><span class="mf">0</span><span class="p">,</span><span class="w">                </span><span class="c1">// stride</span>
<span class="w">  </span><span class="mf">0</span><span class="p">);</span><span class="w">               </span><span class="c1">// offset</span>
</pre></div>
</div>
</div>
<p>The functions used here are explained below;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">positionLocation</span> <span class="pre">=</span> <span class="pre">gl.getAttribLocation(program,</span> <span class="pre">&quot;aPosition&quot;);</span></code> – Gets the location of the <code class="docutils literal notranslate"><span class="pre">aPosition</span></code> attribute from the WebGL shader program.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.enableVertexAttribArray(0);</span></code> – Enables a vertex attribute with location <code class="docutils literal notranslate"><span class="pre">0</span></code> so that WebGL knows to read data from the VBO and pass it to the vertex shader.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.bindBuffer(gl.Array_BUFFER,</span> <span class="pre">vbo);</span></code> – Make the VBO the currently active buffer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl.vertexAttribPointer(positionLocation,</span> <span class="pre">3,</span> <span class="pre">gl.FLOAT,</span> <span class="pre">false,</span> <span class="pre">0,</span> <span class="pre">0);</span></code> – Tells WebGL how to read the data from the currently bound buffer and pass it to the vertex shader attribution <code class="docutils literal notranslate"><span class="pre">0</span></code>. The inputs are explained in the table below.</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Input</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>index</p></td>
<td class="text-left"><p>Attribute location. We stored this in the <code class="docutils literal notranslate"><span class="pre">positionLocation</span></code> variable using the <code class="docutils literal notranslate"><span class="pre">gl.getAttribLocation()</span></code> function.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>size</p></td>
<td class="text-left"><p>Number of components per vertex, We have 3D <span class="math notranslate nohighlight">\((x, y, z)\)</span> co-ordinates, so this is <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>type</p></td>
<td class="text-left"><p>Data type. We are using floats so this is <code class="docutils literal notranslate"><span class="pre">gl_FLOAT</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>normalized</p></td>
<td class="text-left"><p>Whether integer values should be mapped to <span class="math notranslate nohighlight">\([0, 1]\)</span> or <span class="math notranslate nohighlight">\([-1, 1]\)</span>. Our vertex co-ordinates are in NDC, so we don’t need to do this, so we set this to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>stride</p></td>
<td class="text-left"><p>Number of bytes between first attribute of each vertex. Our data is tightly packed, so we can set the stride to <code class="docutils literal notranslate"><span class="pre">0</span></code>, if the array buffer contained other data, e.g., colours, then we would need to determine the number of bytes between the first attribute, e.g., the <span class="math notranslate nohighlight">\(x\)</span> co-ordinates.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>offset</p></td>
<td class="text-left"><p>Number of bytes from the start of the buffer the attribute of the first vertex. Our first vertex co-ordinate is the first element in the buffer, so this is <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The last thing we need to do is actually tell WebGL to draw the triangle.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following after the you have told WebGL how to read the data from the vertex buffer.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Draw the triangle</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">gl.drawArrays()</span></code> function tells the GPU to draw the primitives. The inputs are the type of primitive (we have a triangle), the index of the first vertex and the number of vertices to draw (we have one triangle, so we want to draw 3 vertices). Refresh your browser window, pray to the programming gods and if everything has gone to plan you should see the red triangle displayed on the canvas.</p>
<figure class="align-default" id="hello-triangle-figure">
<a class="reference internal image-reference" href="../_images/02_hello_triangle.png"><img alt="../_images/02_hello_triangle.png" src="../_images/02_hello_triangle.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Hello triangle!</span><a class="headerlink" href="#hello-triangle-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<hr class="docutils" />
<section id="steps-used-to-draw-the-triangle">
<h2>Steps Used to Draw the Triangle<a class="headerlink" href="#steps-used-to-draw-the-triangle" title="Link to this heading">#</a></h2>
<p>Now that we have successfully drawn a triangle, let’s recap the steps we used.</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#triangle-coordinates-section"><span class="std std-ref">Define the Triangle Co-ordinates</span></a> - we defined a 9-element array that contained the <span class="math notranslate nohighlight">\((x, y, z)\)</span> co-ordinates of the 3 triangle vertices.</p></li>
<li><p><a class="reference internal" href="#lab01-triangle-buffer"><span class="std std-ref">Create a Vertex Buffer Object (VBO) for the Triangle</span></a> - the buffer objects are stored in the GPU so we needed to create one for the triangle and copy across the triangle co-ordinates so WebGL can work with them.</p></li>
<li><p><a class="reference internal" href="#vertex-shader-section"><span class="std std-ref">Write and Compile the Vertex Shader</span></a> - a vertex shader is used to transform the vertex co-ordinates to the clip space. The output is sent to the WebGL rasteriser that passes the fragment co-ordinates to the fragment shader.</p></li>
<li><p><a class="reference internal" href="#lab01-fragment-shader"><span class="std std-ref">Write and Compile the Fragment Shader</span></a> - a fragment shader is used to determine the colour that the fragment should be rendered on the display.</p></li>
<li><p><a class="reference internal" href="#lab01-webgl-program"><span class="std std-ref">Link the Shaders into a WebGL Program</span></a> - the vertex and fragment shaders are linked into a single program that we tell WebGL to use to draw the triangle.</p></li>
<li><p><a class="reference internal" href="#lab01-draw-triangle"><span class="std std-ref">Draw the Triangle</span></a> - we need to tell WebGL how to access the data in the triangle buffer and instruct it to draw the triangle.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="webgl-utility-functions">
<h2>WebGL Utility Functions<a class="headerlink" href="#webgl-utility-functions" title="Link to this heading">#</a></h2>
<p>Looking at our <code class="docutils literal notranslate"><span class="pre">main()</span></code> function we see that the code to compile and link the shaders is very similar for the vertex and fragment shaders. In the spirit of DRY (Do not Repeat Yourself), we will now write some utility functions to simplify the code.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Create a new JavaScript files called <em><strong>webGLUtils.js</strong></em> within the <em><strong>Lab 2 Basic Shapes</strong></em> folder, and copy and paste the following code into it</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Initialize WebGL context</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">initWebGL</span><span class="p">(</span><span class="nx">canvas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">&quot;webgl2&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">&quot;webgl&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;WebGL not supported&quot;</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">viewport</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">clearColor</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">COLOR_BUFFER_BIT</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">gl</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Compile a shader</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">source</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">shader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createShader</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">shaderSource</span><span class="p">(</span><span class="nx">shader</span><span class="p">,</span><span class="w"> </span><span class="nx">source</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">shader</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderParameter</span><span class="p">(</span><span class="nx">shader</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">COMPILE_STATUS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderInfoLog</span><span class="p">(</span><span class="nx">shader</span><span class="p">));</span>
<span class="w">    </span><span class="nx">gl</span><span class="p">.</span><span class="nx">deleteShader</span><span class="p">(</span><span class="nx">shader</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">shader</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Create shader program</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">createProgram</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexSource</span><span class="p">,</span><span class="w"> </span><span class="nx">fragmentSource</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">vertexShader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexSource</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">VERTEX_SHADER</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">fragmentShader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">fragmentSource</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FRAGMENT_SHADER</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createProgram</span><span class="p">();</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">attachShader</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexShader</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">attachShader</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">fragmentShader</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">linkProgram</span><span class="p">(</span><span class="nx">program</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getProgramParameter</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">LINK_STATUS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getProgramInfoLog</span><span class="p">(</span><span class="nx">program</span><span class="p">));</span>
<span class="w">    </span><span class="nx">gl</span><span class="p">.</span><span class="nx">deleteProgram</span><span class="p">(</span><span class="nx">program</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">program</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>This new file <em><strong>webGLUtils.js</strong></em> is used to contain any utility functions that are required for WebGL. Here we have defined the functions <code class="docutils literal notranslate"><span class="pre">initWebGL()</span></code> which sets up the WebGL canvas and returns a <code class="docutils literal notranslate"><span class="pre">gl</span></code> object, <code class="docutils literal notranslate"><span class="pre">compileShader()</span></code> which compiles a vertex or fragment shader, and <code class="docutils literal notranslate"><span class="pre">createProgram()</span></code> links the shaders to create a WebGL program. If you compare them to the equivalent code in the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function you can see that they are quite similar. To enable our main file to use these functions we also need to add <code class="docutils literal notranslate"><span class="pre">webGLUtils.js</span></code> to the <em><strong>index.html</strong></em> file using a script tag.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>In the <em><strong>index.html</strong></em> file, add the following just before the <code class="docutils literal notranslate"><span class="pre">basic_shapes.js</span></code> script tag.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> &lt;script src=&quot;webGLUtils.js&quot;&gt;&lt;/script&gt;
</pre></div>
</div>
</div>
<p>We can now tidy up the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function and make a call to out new <code class="docutils literal notranslate"><span class="pre">createprogram()</span></code> function.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>In the <em><strong>basic_shapes.js</strong></em> file, comment out (or delete) the code used to set up the WebGL canvas and replace it with the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Setup WebGL</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">canvas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">initWebGL</span><span class="p">(</span><span class="nx">canvas</span><span class="p">);</span>
</pre></div>
</div>
<p>Comment out (or delete) the code used to compile and link the shaders and replace it with the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create WebGL program </span>
<span class="kd">const</span><span class="w"> </span><span class="nx">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createProgram</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexShaderSource</span><span class="p">,</span><span class="w"> </span><span class="nx">fragmentShaderSource</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>Refresh your browser window and if everything has gone to plan you should see your red triangle as before. This effort is not wasted, we can now easily create WebGL programs from the source code without lots of copying and pasting of existing code. We will be using the <em><strong>webGLUtils.js</strong></em> and other JavaScript files to help organize and simplify our code in the future.</p>
</section>
<hr class="docutils" />
<section id="colours">
<h2>Colours<a class="headerlink" href="#colours" title="Link to this heading">#</a></h2>
<p>So we are able to draw a triangle using WebGL of a single colour. Whilst this is awesome, wouldn’t it be better if we were able to draw triangles using different colours? We will now see how we can add colour data to each vertex and use these in our shaders.</p>
<section id="vertex-and-fragment-shaders">
<h3>Vertex and Fragment Shaders<a class="headerlink" href="#vertex-and-fragment-shaders" title="Link to this heading">#</a></h3>
<p>Our current vertex shader simply takes in an input of a 3-element vector containing the <span class="math notranslate nohighlight">\((x, y, z)\)</span> vertex co-ordinates and outputs a 4-element vector of these co-ordinates to the fragment shader. The vertex co-ordinates are outputted using the <code class="docutils literal notranslate"><span class="pre">gl_Position</span></code> variable which is a required output and is not specifically declared. To add colour data to our co-ordinates we need to declare a second 3-element input vector for the attribute colour as well as an output vector for the vertex colour. So our vertex shader is</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#version 300 es</span>
<span class="n">precision</span><span class="w"> </span><span class="n">mediump</span><span class="w"> </span><span class="kt">float</span><span class="p">;</span>

<span class="n">in</span><span class="w"> </span><span class="n">vec3</span><span class="w"> </span><span class="n">aPosition</span><span class="p">;</span>
<span class="n">in</span><span class="w"> </span><span class="n">vec3</span><span class="w"> </span><span class="n">aColour</span><span class="p">;</span>

<span class="n">out</span><span class="w"> </span><span class="n">vec3</span><span class="w"> </span><span class="n">vColour</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">gl_Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec4</span><span class="p">(</span><span class="n">aPosition</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Output vertex colour</span>
<span class="w">  </span><span class="n">vColour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aColour</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As for the fragment shader, we will simply output the colour data of the vertex. Our current fragment shader does not have an input declared because it expects <code class="docutils literal notranslate"><span class="pre">gl_Position</span></code> by default, so we need to add an input declaration for the vertex colour outputted by the vertex shader and use this to create the 4-element RGBA output vector.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#version 300 es</span>
<span class="n">precision</span><span class="w"> </span><span class="n">mediump</span><span class="w"> </span><span class="kt">float</span><span class="p">;</span>

<span class="n">in</span><span class="w"> </span><span class="n">vec3</span><span class="w"> </span><span class="n">vColour</span><span class="p">;</span>

<span class="n">out</span><span class="w"> </span><span class="n">vec4</span><span class="w"> </span><span class="n">fragColour</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fragColour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec4</span><span class="p">(</span><span class="n">vColour</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Edit the vertex shader code at the top of the <em><strong>basic_shapes.js</strong></em> file so that is contains the modified vertex and fragment shaders shown above.</p>
</div>
</section>
<section id="vertex-colours">
<h3>Vertex Colours<a class="headerlink" href="#vertex-colours" title="Link to this heading">#</a></h3>
<p>To add colour data to the triangle vertices we add 3 more float values for the red, green and blue colours to the <code class="docutils literal notranslate"><span class="pre">vertices</span></code> array.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Amend the <code class="docutils literal notranslate"><span class="pre">vertices</span></code> array so that it looks like the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define triangle vertices</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w"> </span><span class="c1">// x     y    z      r    g    b</span>
<span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0       2</span>
<span class="w">  </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 1     /   \</span>
<span class="w">  </span><span class="mf">0.0</span><span class="p">,</span><span class="w">  </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2    0 --- 1</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<p>Here we have specified vertex 0 is pure red, vertex 1 is pure green and vertex 2 is pure blue. If you refresh your web browser you should see that the red triangle is black and skewed, where it appears that the top vertex has been moved to the right-hand edge of the canvas (<a class="reference internal" href="#skewed-triangle-figure"><span class="std std-numref">Fig. 4</span></a>). The reason why its skewed is that when we told WebGL how to read the vertex buffer using <code class="docutils literal notranslate"><span class="pre">gl.vertexAttribPointer(colourLocation,</span> <span class="pre">3,</span> <span class="pre">gl.FLOAT,</span> <span class="pre">false,</span> <span class="pre">0,</span> <span class="pre">0);</span></code>. This means that WebGL is expected no gaps between the vertex co-ordinate data since the stride input (the second to last input) is <code class="docutils literal notranslate"><span class="pre">0</span></code>, so it thinks the 3 vertex co-ordinates are <span class="math notranslate nohighlight">\((-0.5, -0.5, 0)\)</span>, <span class="math notranslate nohighlight">\((1, 0, 0)\)</span> and <span class="math notranslate nohighlight">\((0.5, -0.5, 0)\)</span>.</p>
<figure class="align-default" id="skewed-triangle-figure">
<a class="reference internal image-reference" href="../_images/02_skewed_triangle.png"><img alt="../_images/02_skewed_triangle.png" src="../_images/02_skewed_triangle.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Oops, something has gone wrong.</span><a class="headerlink" href="#skewed-triangle-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The stride is the number of bytes from the start of the attribute, in our case the <span class="math notranslate nohighlight">\(x\)</span> vertex co-ordinate, for one vertex to the start of the same attribute of the next vertex. We added 3 floats for the RGB data, so our stride is the number of bytes used to store 6 float values, i.e., 3 for the <span class="math notranslate nohighlight">\((x, y, z)\)</span> values and 3 for the RGB values.</p>
<figure class="align-default" id="stride-offset-figure">
<a class="reference internal image-reference" href="../_images/02_stride_offset.svg"><img alt="../_images/02_stride_offset.svg" src="../_images/02_stride_offset.svg" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">The stride and offset of a vertex array.</span><a class="headerlink" href="#stride-offset-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Change the <code class="docutils literal notranslate"><span class="pre">gl.vertexAttribPointer();</span></code> function so that it looks like the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span>
<span class="w">  </span><span class="nx">positionLocation</span><span class="p">,</span><span class="w">                    </span><span class="c1">// index</span>
<span class="w">  </span><span class="mf">3</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// size</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span><span class="w">                            </span><span class="c1">// type</span>
<span class="w">  </span><span class="kc">false</span><span class="p">,</span><span class="w">                               </span><span class="c1">// normalized</span>
<span class="w">  </span><span class="mf">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="p">,</span><span class="w">  </span><span class="c1">// stride</span>
<span class="w">  </span><span class="mf">0</span><span class="w">                                    </span><span class="c1">// offset</span>
<span class="p">);</span><span class="w">          </span>
</pre></div>
</div>
</div>
<p>Refresh your browser, and you should see that the triangle vertices has returned to its previous state, but it’s still black (<a class="reference internal" href="#black-triangle-figure"><span class="std std-numref">Fig. 6</span></a>). The reason for this is that we have not yet told WebGL about our new vertex colours. To do this we get the location of the <code class="docutils literal notranslate"><span class="pre">aColour</span></code> attribute from the vertex shader, enable the attribute array and point WebGL to where it can find the colour data.</p>
<figure class="align-default" id="black-triangle-figure">
<a class="reference internal image-reference" href="../_images/02_black_triangle.png"><img alt="../_images/02_black_triangle.png" src="../_images/02_black_triangle.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Sorted the vertex co-ordinates but not the colour.</span><a class="headerlink" href="#black-triangle-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following code after we told WebGL how to read the co-ordinate data.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">colourLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">getAttribLocation</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;aColour&quot;</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">colourLocation</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span>
<span class="w">  </span><span class="nx">colourLocation</span><span class="p">,</span><span class="w">                      </span><span class="c1">// index</span>
<span class="w">  </span><span class="mf">3</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// size</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span><span class="w">                            </span><span class="c1">// type</span>
<span class="w">  </span><span class="kc">false</span><span class="p">,</span><span class="w">                               </span><span class="c1">// normalized</span>
<span class="w">  </span><span class="mf">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="p">,</span><span class="w">  </span><span class="c1">// stride</span>
<span class="w">  </span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="w">   </span><span class="c1">// offset</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>Note that here the <code class="docutils literal notranslate"><span class="pre">offset</span></code> value is 3 times of the number of bytes used to store a 32-bit float. This is because the colour data comes after the 3 floats for the co-ordinate values.</p>
<p>Refresh your browser you should see the triangle in all its glorious colourfulness.</p>
<figure class="align-default" id="colurful-triangle-figure">
<a class="reference internal image-reference" href="../_images/02_colourful_triangle.png"><img alt="../_images/02_colourful_triangle.png" src="../_images/02_colourful_triangle.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Hello colourful triangle!</span><a class="headerlink" href="#colurful-triangle-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>You can see that the 3 triangle vertices are red, green and blue going anti-clockwise from the bottom-left vertex. The colour of the pixels across the interior of the triangle have been interpolated by the rasteriser so that we have a smooth transition of colours.</p>
</section>
</section>
<hr class="docutils" />
<section id="more-shapes">
<h2>More Shapes<a class="headerlink" href="#more-shapes" title="Link to this heading">#</a></h2>
<p>To keep our colourful triangle company we are going to introduce another shape, a square, to our scene. In most graphics applications shapes are constructed using triangle primitives. Triangles are the simplest 2D shape and all other shapes are constructed using triangles. So to construct a square we need two triangles.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following code after we defined the triangle vertex buffer.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define square vertices</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">squareVertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">  </span><span class="c1">// x  y    z       r    g    b             </span>
<span class="w">  </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0     3 -- 2</span>
<span class="w">  </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 1     |  / |    </span>
<span class="w">  </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2     | /  | </span>
<span class="w">  </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0     0 -- 1 </span>
<span class="w">  </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2</span>
<span class="w">  </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 3</span>
<span class="p">]);</span>

<span class="c1">// Create VBO for the square</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">squareVbo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createBuffer</span><span class="p">();</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">squareVbo</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bufferData</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">squareVertices</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">STATIC_DRAW</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>Here we have defined the co-ordinates and colours for vertices of a square. We are using 2 triangles to construct the square, so we have 6 vertices in total. Like with the triangle, we have also created a vertex buffer for the square and copied the data across to the GPU. We now need to tell WebGL how to read the square vertex buffer and to draw the 2 triangles that make up the square.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Enter the following code after we have drawn the triangle.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Tell WebGL how to read data from the square vertex buffer</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">squareVbo</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">positionLocation</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span><span class="nx">positionLocation</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">colourLocation</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span><span class="nx">colourLocation</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="p">);</span>

<span class="c1">// Draw the square</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>This is very similar to what we did for the triangle object, i.e., we bind the vertex buffer for the square, enable the vertex attribute array and tell WebGL where the data is. Note that we already know the location of the position and colour attributes. Since we are drawing two triangles, we change the 3 to a 6 in the <code class="docutils literal notranslate"><span class="pre">gl.drawArrays()</span></code> function.</p>
<figure class="align-default" id="colourful-shapes-figure">
<a class="reference internal image-reference" href="../_images/02_triangle_and_square.png"><img alt="../_images/02_triangle_and_square.png" src="../_images/02_triangle_and_square.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Our triangle now has a friend.</span><a class="headerlink" href="#colourful-shapes-figure" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<hr class="docutils" />
<section id="vertex-array-objects-vao">
<h2>Vertex Array Objects (VAO)<a class="headerlink" href="#vertex-array-objects-vao" title="Link to this heading">#</a></h2>
<p>You may have noticed that telling WebGL how to read the VBOs for both the triangle and square objects required repetition of code. Every time we draw a different object we are repeating this code, with just 2 objects this isn’t too bad, but when we are dealing with hundreds of objects it will become unmanageable. A <strong>Vertex Array Object (VAO)</strong> is a WebGL object that stores all the state related to the vertex, i.e., vertex attributes and bindings to attribute locations, so that once it is set up we only need a single block of code to bind the VAO and draw the object.</p>
<p>We are going to create a utility function to create a VAO.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Copy and paste the following function definition to the <em><strong>webGLUtils.js</strong></em> file.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create VAO</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">vertices</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1">// Create VAO</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">vao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createVertexArray</span><span class="p">();</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="nx">vao</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Create VBO</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">vbo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createBuffer</span><span class="p">();</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">vbo</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">bufferData</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">vertices</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">STATIC_DRAW</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Position attribute</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">stride</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">positionLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">getAttribLocation</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;aPosition&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">positionLocation</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span><span class="nx">positionLocation</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">stride</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Colour attribute</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">.</span><span class="nx">BYTES_PER_ELEMENT</span><span class="p">;</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">colourLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">getAttribLocation</span><span class="p">(</span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;aColour&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">colourLocation</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span><span class="nx">colourLocation</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">stride</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Unbind VAO</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">vao</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Here we create a VAO using the <code class="docutils literal notranslate"><span class="pre">gl.createVertexArray()</span></code> function and bind it. Then we create the VBO and tell WebGL how to access the data using the same commands as before. The last thing we do before returning the VAO is to unbind it so that we don’t accidentally make changes with subsequent code.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Delete (or comment out) any commands used to create the VBOs for the triangle and square and commands used to tell WebGL how to read the data and draw the triangle and square.</p>
<p>Then use the following commands to create the VAOs for the triangle and square and draw them.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create VAOs</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">triangleVao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">vertices</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">squareVao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">squareVertices</span><span class="p">);</span>

<span class="c1">// Draw triangle</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="nx">triangleVao</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>

<span class="c1">// Draw square</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="nx">squareVao</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">);</span>
</pre></div>
</div>
<p>Your <code class="docutils literal notranslate"><span class="pre">main()</span></code> function should now look something like the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="c1">// Setup WebGL</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">canvas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">initWebGL</span><span class="p">(</span><span class="nx">canvas</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Create WebGL program </span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createProgram</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">vertexShaderSource</span><span class="p">,</span><span class="w"> </span><span class="nx">fragmentShaderSource</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Set the shader program</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">useProgram</span><span class="p">(</span><span class="nx">program</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Define triangle vertices</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">    </span><span class="c1">// x     y    z      r    g    b</span>
<span class="w">    </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0       2</span>
<span class="w">     </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 1     /   \</span>
<span class="w">     </span><span class="mf">0.0</span><span class="p">,</span><span class="w">  </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2    0 --- 1</span>
<span class="w">  </span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// Define square vertices</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">squareVertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w">    </span><span class="c1">// x  y    z       r    g    b             </span>
<span class="w">    </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0     3 -- 2</span>
<span class="w">    </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 1     |  / |    </span>
<span class="w">    </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2     | /  | </span>
<span class="w">    </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0     0 -- 1 </span>
<span class="w">    </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2</span>
<span class="w">    </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 3</span>
<span class="w">  </span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// Create VAOs</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">triangleVao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">vertices</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">squareVao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">squareVertices</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Draw the triangle</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="nx">triangleVao</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Draw the square</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="nx">squareVao</span><span class="p">);</span>
<span class="w">  </span><span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Refresh your web browser, and you should see that we still have the colourful triangle and square, good news as it means the VAOs are working.</p>
</section>
<hr class="docutils" />
<section id="element-buffer-objects">
<h2>Element Buffer Objects<a class="headerlink" href="#element-buffer-objects" title="Link to this heading">#</a></h2>
<p>To add the square to our scene we used 6 vertices, 3 for each of the triangle. Two of these vertices, 0 and 2, are shared by both triangles, so we are using more memory than required. To avoid redundant vertex data being created and using up memory, we can define an array of the <strong>indices</strong> for each triangle which maps to the vertex data. The buffer that we use to store the indices is called the <strong>Element Buffer Object (EBO)</strong>.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Edit the code used to define the vertices for the square so that it looks like the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define square vertices</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">squareVertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">([</span>
<span class="w"> </span><span class="c1">// x  y    z       r    g    b             </span>
<span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 0     3 -- 2</span>
<span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 1     |  / |    </span>
<span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 2     | /  | </span>
<span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">    </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// vertex 3     0 -- 1 </span>
<span class="p">]);</span>
</pre></div>
</div>
<p>And add the following arrays after the square vertices have been defined.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define triangle indices</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint16Array</span><span class="p">([</span>
<span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span>
<span class="p">]);</span>

<span class="c1">// Define square indices</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">squareIndices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint16Array</span><span class="p">([</span>
<span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w">  </span><span class="c1">// lower-right triangle</span>
<span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w">  </span><span class="c1">// upper-left triangle</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<p>Here we have reduced the square vertices array to only include one instance of the four vertices and have defined two 16-bit integer arrays for the indices of the triangle and square. We now need to update the <code class="docutils literal notranslate"><span class="pre">createVao()</span></code> utility function to use these index arrays.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Add an input for the index array in the <code class="docutils literal notranslate"><span class="pre">createVao()</span></code> function.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create VAO</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">vertices</span><span class="p">,</span><span class="w"> </span><span class="nx">indices</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</pre></div>
</div>
<p>And add the following code after we create the VBO.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create EBO</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">ebo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">createBuffer</span><span class="p">();</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ELEMENT_ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">ebo</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bufferData</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ELEMENT_ARRAY_BUFFER</span><span class="p">,</span><span class="w"> </span><span class="nx">indices</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">STATIC_DRAW</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>These commands a similar those used for the vertex buffer. Note that here we need to specify that we have an element array buffer instead of a standard array buffer. The index buffer does not contain any data specific to the vertices, so we don’t need to add it to a VAO, instead we bind it whilst the VAO is bound and WebGL “remembers” it as part of the VAO’s state.</p>
<p>Finally, we need to tell WebGL that our data for the square is defined using indices.</p>
<div class="tip admonition">
<p class="admonition-title">Task</p>
<p>Change the function calls to <code class="docutils literal notranslate"><span class="pre">createVao()</span></code> so that they include the indices arrays</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create VAOs</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">triangleVao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">vertices</span><span class="p">,</span><span class="w"> </span><span class="nx">indices</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">squareVao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createVao</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span><span class="w"> </span><span class="nx">program</span><span class="p">,</span><span class="w"> </span><span class="nx">squareVertices</span><span class="p">,</span><span class="w"> </span><span class="nx">squareIndices</span><span class="p">);</span>
</pre></div>
</div>
<p>Replace the <code class="docutils literal notranslate"><span class="pre">gl.drawArrays()</span></code> command for the square with the following</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Draw the triangle</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="nx">triangleVao</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">drawElements</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="nx">indices</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">UNSIGNED_SHORT</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>

<span class="c1">// Draw the square</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindVertexArray</span><span class="p">(</span><span class="nx">squareVao</span><span class="p">);</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">drawElements</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span><span class="w"> </span><span class="nx">squareIndices</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="nx">gl</span><span class="p">.</span><span class="nx">UNSIGNED_SHORT</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>Refresh your browser, and you should see that the output has not changed, but we can now draw different objects easily by binding its VAO and using the draw command.</p>
</section>
<hr class="docutils" />
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Change the vertex shader so that the following results are achieved.</p></li>
</ol>
<p>  (a) The triangle is shifted by 0.75 to the right. Hint: individual elements of a GLSL vector <code class="docutils literal notranslate"><span class="pre">vector</span></code> can be accessed using <code class="docutils literal notranslate"><span class="pre">vector.x</span></code>, <code class="docutils literal notranslate"><span class="pre">vector.y</span></code> and <code class="docutils literal notranslate"><span class="pre">vector.z</span></code> for the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> elements. This is known as <a href="https://en.wikipedia.org/wiki/Swizzling_(computer_graphics)" target="_blank">swizzling</a>.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_ex1a.png"><img alt="../_images/02_ex1a.png" src="../_images/02_ex1a.png" style="width: 60%;" />
</a>
</figure>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Hint</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We can access individual elements of the <code class="docutils literal notranslate"><span class="pre">aPosition</span></code> vectors using <code class="docutils literal notranslate"><span class="pre">aPosition.x</span></code>, <code class="docutils literal notranslate"><span class="pre">aPosition.y</span></code> and <code class="docutils literal notranslate"><span class="pre">aPosition.z</span></code> – this is known as <a href="https://wikis.khronos.org/opengl/Data_Type_(GLSL)#Swizzling" target="_blank">swizzling</a>.</p>
</div>
</details><p>  (b) The triangle is drawn upside-down.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_ex1b.png"><img alt="../_images/02_ex1b.png" src="../_images/02_ex1b.png" style="width: 60%;" />
</a>
</figure>
<p>  (c) The <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> co-ordinates are swapped.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_ex1c.png"><img alt="../_images/02_ex1c.png" src="../_images/02_ex1c.png" style="width: 60%;" />
</a>
</figure>
<ol class="arabic simple" start="2">
<li><p>Use two triangles to draw a green rectangle with lower-left vertex at <span class="math notranslate nohighlight">\((-0.5, -0.5, 0)\)</span> and the upper-right vertex at <span class="math notranslate nohighlight">\((0.5, 0.5, 0)\)</span>.</p></li>
</ol>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_ex2.png"><img alt="../_images/02_ex2.png" src="../_images/02_ex2.png" style="width: 60%;" />
</a>
</figure>
<ol class="arabic simple" start="3">
<li><p>Use triangles to draw a blue hexagon.</p></li>
</ol>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_ex3.png"><img alt="../_images/02_ex3.png" src="../_images/02_ex3.png" style="width: 60%;" />
</a>
</figure>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Hint</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We can draw a hexagon using 6 triangles where each triangle has one vertex at <span class="math notranslate nohighlight">\((0,0,0)\)</span> and two outer vertices that lie on the circumference of a circle.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_hexagon.svg"><img alt="../_images/02_hexagon.svg" src="../_images/02_hexagon.svg" style="width: 450px;" />
</a>
</figure>
<p class="sd-card-text">The <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> vertices of the two outer vertices are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
  x_i &amp;= r \cos(\theta_i), &amp; y_i &amp;= r \sin(\theta_i), \\
  x_{i+1} &amp;= r \cos(\theta_{i+1}), &amp; y_{i+1} &amp;= r \sin(\theta_{i+1}),
\end{align*}\end{split}\]</div>
<p class="sd-card-text">where <span class="math notranslate nohighlight">\(r\)</span> is the radius and the angles <span class="math notranslate nohighlight">\(\theta_i\)</span> and <span class="math notranslate nohighlight">\(\theta_{i+1}\)</span> are calculated using</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
  \theta_i &amp;= \frac{i2\pi}{6}, \\
  \theta_{i+1} &amp;= \frac{(i+1)2\pi}{6}.
\end{align*}\end{split}\]</div>
</div>
</details><ol class="arabic simple" start="4">
<li><p>Use lots of triangles to draw a yellow circle.</p></li>
</ol>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/02_ex4.png"><img alt="../_images/02_ex4.png" src="../_images/02_ex4.png" style="width: 60%;" />
</a>
</figure>
</section>
<hr class="docutils" />
<section id="video-walkthrough">
<h2>Video walkthrough<a class="headerlink" href="#video-walkthrough" title="Link to this heading">#</a></h2>
<iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/E1w1_Cy8_uI?si=9Af9TH0qz3F-p05a"
  title="YouTube video player"
  frameborder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
  referrerpolicy="strict-origin-when-cross-origin"
  allowfullscreen
></iframe>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./_pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01_intro_to_javascript.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 1: Introduction to JavaScript</p>
      </div>
    </a>
    <a class="right-next"
       href="03_Textures.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 3: Textures</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-html-and-javascript-files">Setup HTML and JavaScript Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#draw-a-red-triangle">Draw a Red Triangle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-triangle-co-ordinates">Define the Triangle Co-ordinates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-vertex-buffer-object-vbo-for-the-triangle">Create a Vertex Buffer Object (VBO) for the Triangle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-and-compile-the-vertex-shader">Write and Compile the Vertex Shader</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-and-compile-the-fragment-shader">Write and Compile the Fragment Shader</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#link-the-shaders-into-a-webgl-program">Link the Shaders into a WebGL Program</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#draw-the-triangle">Draw the Triangle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-used-to-draw-the-triangle">Steps Used to Draw the Triangle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#webgl-utility-functions">WebGL Utility Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colours">Colours</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-and-fragment-shaders">Vertex and Fragment Shaders</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-colours">Vertex Colours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-shapes">More Shapes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-array-objects-vao">Vertex Array Objects (VAO)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#element-buffer-objects">Element Buffer Objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-walkthrough">Video walkthrough</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Jon Shiach
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>